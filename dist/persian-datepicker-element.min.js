!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.PersianDatePickerElement=e():t.PersianDatePickerElement=e()}("void 0"!=typeof self?self:"void 0"!=typeof window?window:"void 0"!=typeof global?global:this,(()=>(()=>{"use strict";var t={d:(e,i)=>{for(var r in i)t.o(i,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:i[r]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};t.d(e,{default:()=>b});const i={g_days_in_month:[31,28,31,30,31,30,31,31,30,31,30,31],j_days_in_month:[31,31,31,31,31,31,30,30,30,30,30,29],jalaliToGregorian:function(t,e,i){const r=(t=parseInt(""+t))-979,s=(e=parseInt(""+e))-1,a=(i=parseInt(""+i))-1;let o=365*r+8*Math.floor(r/33)+Math.floor((r%33+3)/4);for(let t=0;t<s;++t)o+=this.j_days_in_month[t];o+=a;let n=o+79,d=1600+400*Math.floor(n/146097);n%=146097;let h=!0;n>=36525&&(n--,d+=100*Math.floor(n/36524),n%=36524,n>=365?n++:h=!1),d+=4*Math.floor(n/1461),n%=1461,n>=366&&(h=!1,n--,d+=Math.floor(n/365),n%=365);let c=0;for(;n>=this.g_days_in_month[c]+(1===c&&h?1:0);c++)n-=this.g_days_in_month[c]+(1===c&&h?1:0);return[d,c+1,n+1]},gregorianToJalali:function(t,e,i){const r=(t=parseInt(""+t))-1600,s=(e=parseInt(""+e))-1,a=(i=parseInt(""+i))-1;let o=365*r+Math.floor((r+3)/4)-Math.floor((r+99)/100)+Math.floor((r+399)/400);for(let t=0;t<s;++t)o+=this.g_days_in_month[t];s>1&&(r%4==0&&r%100!=0||r%400==0)&&o++,o+=a;let n=o-79;const d=Math.floor(n/12053);n%=12053;let h=979+33*d+4*Math.floor(n/1461);n%=1461,n>=366&&(h+=Math.floor((n-1)/365),n=(n-1)%365);let c=0;for(;c<11&&n>=this.j_days_in_month[c];++c)n-=this.j_days_in_month[c];return[h,c+1,n+1]},isLeapJalaliYear:function(t){return[1,5,9,13,17,22,26,30].includes(t%33)},getDaysInMonth:function(t,e){return e<1||e>12?0:e<=6?31:e<=11||this.isLeapJalaliYear(t)?30:29},getMonthName:function(t){return["فروردین","اردیبهشت","خرداد","تیر","مرداد","شهریور","مهر","آبان","آذر","دی","بهمن","اسفند"][t-1]},getDayOfWeek:function(t,e,i){const r=this.jalaliToGregorian(t,e,i);return new Date(r[0],r[1]-1,r[2]).getDay()},getDaysInYear:function(t){return this.isLeapJalaliYear(t)?366:365},isValidDate:function(t,e,i){return!(t<0||e<1||e>12||i<1)&&i<=this.getDaysInMonth(t,e)}};function r(t,e,r){const s=i.jalaliToGregorian(t,e,r);return new Date(s[0],s[1]-1,s[2]).toISOString()}const s=new Date,a=i.gregorianToJalali(s.getFullYear(),s.getMonth()+1,s.getDate())[0],o=[];class n{constructor(){this.mappedEvents=[...o],this.persianCalendarData={"Persian Calendar":[],"Hijri Calendar":[],Source:{name:"Fallback Data",url:""}},this.isLoading=!1,this.lastFetchYear=""[0],this.fetchPromise=""[0],this.isInitialized=!1,this.CACHE_KEY="persian_calendar_events",this.CACHE_EXPIRY_DAYS=7}static getInstance(){return n.instance||(n.instance=new n),n.instance}static isInitialized(){return n.instance?.isInitialized??!1}static async initialize(){if(n.initializationPromise)return n.initializationPromise;n.initializationPromise=n.getInstance().loadEventsData();try{await n.initializationPromise}finally{n.initializationPromise=""[0]}}mapPersianCalendarEvents(){try{let t=[];return this.persianCalendarData&&this.persianCalendarData["Persian Calendar"]&&Array.isArray(this.persianCalendarData["Persian Calendar"])&&(t=this.persianCalendarData["Persian Calendar"].map((t=>{const e=t.month||1,i=t.day||1;return{title:t.title||"",month:e,day:i,type:t.type||"Iran",holiday:t.holiday||!1,isoString:r(a,e,i)}}))),t}catch(t){return[...o]}}saveToCache(t){try{const e={data:t,timestamp:(new Date).getTime(),year:this.lastFetchYear};localStorage.setItem(this.CACHE_KEY,JSON.stringify(e))}catch(t){}}getFromCache(){try{const t=localStorage.getItem(this.CACHE_KEY);if(!t)return""[0];const{data:e,timestamp:i,year:r}=JSON.parse(t);return(new Date).getTime()-i>24*this.CACHE_EXPIRY_DAYS*60*60*1e3||r!==this.lastFetchYear?(localStorage.removeItem(this.CACHE_KEY),""[0]):e}catch(t){return""[0]}}async loadEventsData(){if(this.fetchPromise)return void await this.fetchPromise;const t=new Date,e=i.gregorianToJalali(t.getFullYear(),t.getMonth()+1,t.getDate())[0],r=this.getFromCache();if(r)return this.persianCalendarData=r,this.mappedEvents=this.mapPersianCalendarEvents(),this.lastFetchYear=e,void(this.isInitialized=!0);this.fetchPromise=(async()=>{this.isLoading=!0;try{const t=await this.fetchWithRetry("data/events.json",3);if(!t.ok)throw Error("HTTP error! status:"+t.status);this.persianCalendarData=await t.json(),this.saveToCache(this.persianCalendarData);const i=this.mapPersianCalendarEvents();this.mappedEvents=[...i],this.lastFetchYear=e,this.isInitialized=!0}catch(t){this.mappedEvents=[...o]}finally{this.isLoading=!1}})();try{await this.fetchPromise}finally{this.fetchPromise=""[0]}}async fetchWithRetry(t,e){let i=""[0];for(let r=0;r<e;r++)try{const e=await fetch(t);if(e.ok)return e;throw Error("HTTP error! status:"+e.status)}catch(t){i=t,r<e-1&&await new Promise((t=>setTimeout(t,1e3*Math.pow(2,r))))}throw i||Error("Failed to fetch events data after multiple retries")}getEvents(t,e,i,s=!1){return this.getAllEvents(i,s).filter((i=>i.month===t&&i.day===e)).map((t=>t.isoString?t:{...t,isoString:r(a,t.month,t.day)}))}getEvent(t,e){const i=this.mappedEvents.find((i=>i.month===t&&i.day===e));return i&&!i.isoString?{...i,isoString:r(a,i.month,i.day)}:i}getEventsForMonth(t){return this.mappedEvents.filter((e=>e.month===t)).map((t=>t.isoString?t:{...t,isoString:r(a,t.month,t.day)}))}getEventsForYear(){return this.mappedEvents.map((t=>t.isoString?t:{...t,isoString:r(a,t.month,t.day)}))}isHoliday(t,e,i,r=!1){return this.getEvents(t,e,i,r).some((t=>!0===t.holiday))}getHolidayTitles(t,e,i,r=!1){return this.getEvents(t,e,i,r).filter((t=>!0===t.holiday)).map((t=>t.title))}getAllEventTitles(t,e,i,r=!1){return this.getEvents(t,e,i,r).map((t=>t.title))}getAllEvents(t,e=!1){let i;return i=e?[...this.mappedEvents]:this.mappedEvents.filter((e=>t?.includes(e.type)??!0)),i.map((t=>t.isoString?t:{...t,isoString:r(a,t.month,t.day)}))}getEventsByType(t,e=!1,i=!1){const r=e?this.mappedEvents:this.mappedEvents.filter((e=>e.type===t));return i?r.filter((t=>!0===t.holiday)):r}getAllHolidays(t,e=!1){return this.getAllEvents(t,e).filter((t=>!0===t.holiday))}getEventTypes(){const t=new Set;return this.mappedEvents.forEach((e=>t.add(e.type))),Array.from(t)}getSourceMetadata(){return this.persianCalendarData.Source||{}}async refreshEvents(){if(!this.isLoading){this.fetchPromise=(async()=>{this.isLoading=!0;try{const t=await this.fetchWithRetry("data/events.json",3);if(!t.ok)throw Error("HTTP error! status:"+t.status);this.persianCalendarData=await t.json(),this.saveToCache(this.persianCalendarData);const e=this.mapPersianCalendarEvents();this.mappedEvents=[...e];const r=new Date,s=i.gregorianToJalali(r.getFullYear(),r.getMonth()+1,r.getDate());this.lastFetchYear=s[0]}catch(t){}finally{this.isLoading=!1}})();try{await this.fetchPromise}finally{this.fetchPromise=""[0]}}return[...this.mappedEvents]}}n.instance=""[0],n.initializationPromise=""[0];const d=n;class h{static toPersianNum(t){const e=["۰","۱","۲","۳","۴","۵","۶","۷","۸","۹"];return(""+t).replace(/\d/g,(t=>e[parseInt(t)]))}static fromPersianNum(t){const e=["۰","۱","۲","۳","۴","۵","۶","۷","۸","۹"];return parseInt(t.replace(/[۰-۹]/g,(t=>""+e.indexOf(t))))}static compareDates(t,e){return t[0]!==e[0]?t[0]-e[0]:t[1]!==e[1]?t[1]-e[1]:t[2]-e[2]}static isDateInRange(t,e,i,r,s){if(!r&&!s)return!0;const a=[t,e,i];return!(r&&this.compareDates(a,r)<0||s&&this.compareDates(a,s)>0)}static isDateDisabled(t,e,i,r){return!!r&&r(t,e,i)}static jalaliToISOString(t,e){if(!t)return"";const i=e.jalaliToGregorian(t[0],t[1],t[2]);return new Date(i[0],i[1]-1,i[2]).toISOString()}static isValidFormat(t){const e=t.includes("YYYY"),i=t.includes("MM"),r=t.includes("DD"),s=/[^YMD\/\-\. dth]/g.test(t);return"YYYY/MM"===t||"DD/MM"===t||"DD.MM.YYYY"===t||"YYYY/MM/DDth"===t||[e,i,r].filter(Boolean).length>=2&&!s}static getWeekdayName(t,e,i){return["شنبه","یکشنبه","دوشنبه","سه‌شنبه","چهارشنبه","پنج‌شنبه","جمعه"][new Date(t,e-1,i).getDay()]}static getTodayJalali(t){const e=new Date;return t.gregorianToJalali(e.getFullYear(),e.getMonth()+1,e.getDate())}static getTomorrowJalali(t){const e=new Date;return e.setDate(e.getDate()+1),t.gregorianToJalali(e.getFullYear(),e.getMonth()+1,e.getDate())}}class c{static generateHeaderHTML(t){const e='<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"/></svg>';return`\n      <div class="header">\n        ${t.showPrevButton?'<button id="prev-month" type="button" class="nav-button prev"></button>':""}\n        <div class="selectors-container">\n          ${t.showMonthSelector?`\n          <div class="custom-select month-select" id="month-select-container">\n            <button type="button" class="select-trigger" id="month-select-trigger">\n              <span id="month-select-value"></span>\n              <span class="select-icon">${e}</span>\n            </button>\n            <div class="select-content month-select-content" id="month-select-content"></div>\n          </div>\n          `:""}\n          ${t.showYearSelector?`\n          <div class="custom-select year-select" id="year-select-container">\n            <button type="button" class="select-trigger" id="year-select-trigger">\n              <span id="year-select-value"></span>\n              <span class="select-icon">${e}</span>\n            </button>\n            <div class="select-content year-select-content" id="year-select-content"></div>\n          </div>\n          `:""}\n        </div>\n        ${t.showNextButton?'<button id="next-month" type="button" class="nav-button next"></button>':""}\n      </div>\n    `}static generateFooterHTML(t,e){return`\n      <div class="footer">\n        ${t.showTodayButton?`<button id="today-button" type="button" class="date-nav-button today-button ${e.todayButtonClass}">${e.todayButtonText}</button>`:""}\n        ${t.showTomorrowButton?`<button id="tomorrow-button" type="button" class="date-nav-button tomorrow-button ${e.tomorrowButtonClass}">${e.tomorrowButtonText}</button>`:""}\n      </div>\n    `}static generateComponentHTML(t,e){return`<div class="picker-container"> <input type="text" id="date-input" readonly placeholder="انتخاب تاریخ"> <div class="calendar" id="calendar"> ${this.generateHeaderHTML(t)}<div class="day-names" id="day-names"></div> <div class="days-wrapper"> <div class="days" id="days-container"></div> </div> ${this.generateFooterHTML(t,e)}</div> </div>`}static initializeDayNames(t){t.innerHTML="",this.dayNames.forEach((e=>{const i=document.createElement("div");i.classList.add("day-name"),i.textContent=e,t.appendChild(i)}))}static createMonthOptions(t,e){const i=document.createDocumentFragment();return this.persianMonths.forEach(((r,s)=>{const a=s+1,o=document.createElement("div");o.classList.add("select-item"),o.textContent=r,o.dataset.value=""+a,a===t&&o.classList.add("selected"),o.addEventListener("click",(t=>{t.stopPropagation(),e(a,r)})),i.appendChild(o)})),i}static createYearOptions(t,e,i){const r=document.createDocumentFragment(),s=t+50;for(let a=t-100;a<=s;a++){const s=document.createElement("div");s.classList.add("select-item"),s.textContent=i(a),s.dataset.value=""+a,a===t&&s.classList.add("selected"),s.addEventListener("click",(t=>{t.stopPropagation(),e(a)})),r.appendChild(s)}return r}static createEventTooltip(t){const e=document.createElement("div");return e.classList.add("event-tooltip"),t.forEach((t=>{const i=document.createElement("div");i.classList.add("event-item"),t.holiday&&i.classList.add("holiday");const r=document.createElement("span");r.classList.add("event-type-label"),r.textContent=this.holidayTypeLabels[t.type]||t.type,i.appendChild(r);const s=document.createElement("span");s.textContent=t.title,i.appendChild(s),e.appendChild(i)})),e}static getPersianMonths(){return this.persianMonths}static getHolidayTypeLabels(){return{...this.holidayTypeLabels}}}c.persianMonths=["فروردین","اردیبهشت","خرداد","تیر","مرداد","شهریور","مهر","آبان","آذر","دی","بهمن","اسفند"],c.dayNames=["ش","ی","د","س","چ","پ","ج"],c.holidayTypeLabels={Iran:"ایران",Afghanistan:"افغانستان",AncientIran:"ایران باستان",International:"بین‌المللی"};class l{constructor(t,e,i){this.calendar=t,this.onMonthChange=e,this.isTransitioning=i,this.touchStartX=0,this.touchStartY=0,this.touchStartTime=0,this.isScrolling=!1,this.canPreventScroll=!0,this.isDragging=!1,this.isSwiping=!1,this.initTouchGestures()}initTouchGestures(){this.calendar&&(this.calendar.addEventListener("touchstart",this.handleTouchStart.bind(this),{passive:!0}),this.calendar.addEventListener("touchmove",this.handleTouchMove.bind(this),{passive:!1}),this.calendar.addEventListener("touchend",this.handleTouchEnd.bind(this),{passive:!0}),this.calendar.addEventListener("touchcancel",this.handleTouchCancel.bind(this),{passive:!0}),this.calendar.style.touchAction="pan-y pinch-zoom")}handleTouchStart(t){if(!this.calendar?.classList.contains("visible"))return;if(1!==t.touches.length)return;const e=t.touches[0];this.touchStartX=e.clientX,this.touchStartY=e.clientY,this.touchStartTime=Date.now(),this.isScrolling=!1,this.canPreventScroll=!0,this.isDragging=!0,this.isSwiping=!1}handleTouchMove(t){if(!this.calendar?.classList.contains("visible"))return;if(!this.isDragging||1!==t.touches.length)return;const e=t.touches[0],i=e.clientX-this.touchStartX,r=e.clientY-this.touchStartY;if(this.isScrolling||(this.isScrolling=Math.abs(r)>Math.abs(i)),this.isScrolling)this.canPreventScroll=!1;else if(this.isSwiping?t.preventDefault():Math.abs(i)>Math.abs(r)&&Math.abs(i)>10&&(this.isSwiping=!0,t.preventDefault()),Math.abs(i)>10&&this.canPreventScroll)try{t.preventDefault()}catch(t){this.canPreventScroll=!1}}handleTouchEnd(t){if(this.calendar?.classList.contains("visible")&&!this.isScrolling&&this.isDragging){if(this.isSwiping){const e=t.changedTouches[0].clientX-this.touchStartX;Math.abs(e)>50&&this.onMonthChange(e>0?-1:1)}else{const e=t.changedTouches[0].clientX-this.touchStartX;if(Date.now()-this.touchStartTime<300&&Math.abs(e)>50&&!this.isTransitioning()){const t="rtl"===getComputedStyle(this.calendar).getPropertyValue("--jdp-direction").trim();t&&e<0||!t&&e>0?this.onMonthChange(1):(t&&e>0||!t&&e<0)&&this.onMonthChange(-1)}}this.isDragging=!1,this.isSwiping=!1}}handleTouchCancel(){this.isDragging=!1,this.isSwiping=!1,this.isScrolling=!1,this.canPreventScroll=!0}static preventTouchPropagation(t){t.addEventListener("touchstart",(t=>t.stopPropagation()),{passive:!0})}destroy(){this.calendar&&(this.calendar.removeEventListener("touchstart",this.handleTouchStart.bind(this)),this.calendar.removeEventListener("touchmove",this.handleTouchMove.bind(this)),this.calendar.removeEventListener("touchend",this.handleTouchEnd.bind(this)),this.calendar.removeEventListener("touchcancel",this.handleTouchCancel.bind(this)))}}class p{static toPersianNum(t){const e=["۰","۱","۲","۳","۴","۵","۶","۷","۸","۹"];return(""+t).replace(/\d/g,(t=>e[parseInt(t)]))}static fromPersianNum(t){const e=["۰","۱","۲","۳","۴","۵","۶","۷","۸","۹"];return parseInt(t.replace(/[۰-۹]/g,(t=>""+e.indexOf(t))))}static formatDate(t,e){if(!t)return"";const[i,r,s]=t,a=this.handleSpecialFormat(e,i,r,s);return a!==""[0]?a:this.handleGeneralFormat(e,i,r,s)}static handleSpecialFormat(t,e,i,r){const s={"YYYY/MM/DD":()=>`${this.toPersianNum(e)}/${this.toPersianNum((""+i).padStart(2,"0"))}/${this.toPersianNum((""+r).padStart(2,"0"))}`,"YYYY-MM-DD":()=>`${this.toPersianNum(e)}-${this.toPersianNum((""+i).padStart(2,"0"))}-${this.toPersianNum((""+r).padStart(2,"0"))}`,"YYYY/MM/DDth":()=>`${this.toPersianNum(e)}/${this.toPersianNum((""+i).padStart(2,"0"))}/${this.toPersianNum(r)}ام`};return s[t]?.()||""[0]}static handleGeneralFormat(t,e,i,r){const s=t.split(/(\s+)/),a=[];for(let t=0;t<s.length;t++){const o=s[t];if(!o.trim()){a.push(o);continue}let n=this.replaceFormatTokens(o,e,i,r);a.push(n),t<s.length-1&&s[t+1].trim()&&a.push(" ")}return a.join("")}static replaceFormatTokens(t,e,i,r){let s=t;return s.includes("dddd")&&(s=s.replace("dddd",this.getWeekdayName(e,i,r))),s.includes("MMMM")?s=s.replace("MMMM",this.persianMonths[i-1]):s.includes("MMM")&&(s=s.replace("MMM",this.persianMonths[i-1].substring(0,3))),s=s.replace("YYYY",this.toPersianNum(e)),s=s.replace("MM",this.toPersianNum((""+i).padStart(2,"0"))),s=s.replace("DD",this.toPersianNum((""+r).padStart(2,"0"))),s.includes("th")&&(s=s.replace("th","ام")),s}static getWeekdayName(t,e,i){const r=new Date(t,e-1,i).getDay();return this.weekdays[r]}static isValidFormat(t){const e=t.includes("YYYY"),i=t.includes("MM"),r=t.includes("DD"),s=/[^YMD\/\-\. dth]/g.test(t);return"YYYY/MM"===t||"DD/MM"===t||"DD.MM.YYYY"===t||"YYYY/MM/DDth"===t||[e,i,r].filter(Boolean).length>=2&&!s}static getPersianMonths(){return this.persianMonths}static formatDateRange(t,e,i){return`${this.formatDate(t,i)}- ${this.formatDate(e,i)}`}}p.persianMonths=["فروردین","اردیبهشت","خرداد","تیر","مرداد","شهریور","مهر","آبان","آذر","دی","بهمن","اسفند"],p.weekdays=["شنبه","یکشنبه","دوشنبه","سه‌شنبه","چهارشنبه","پنج‌شنبه","جمعه"];class u{constructor(t,e,i,r,s){this.persianDateClass=t,this.eventUtils=e,this.showEvents=i,this.eventTypes=r,this.includeAllTypes=s}renderCalendar(t,e,i,r,s,a,o,n,d,h){t&&(t.innerHTML="",this.renderCalendarContent(t,e,i,r,s,a,o,n,d,h))}renderCalendarContent(t,e,i,r,s,a,o,n,d,c){const l=this.persianDateClass.getDayOfWeek(e,i,1),u=this.persianDateClass.getDaysInMonth(e,i),g=new Date,v=this.persianDateClass.gregorianToJalali(g.getFullYear(),g.getMonth()+1,g.getDate()),b=(l+1)%7,m=document.createDocumentFragment();for(let t=0;t<b;t++){const t=document.createElement("div");t.classList.add("day","empty"),m.appendChild(t)}for(let t=1;t<=u;t++){const l=document.createElement("div");l.classList.add("day"),l.textContent=p.toPersianNum(t),l.dataset.day=""+t;const u=h.isDateInRange(e,i,t,n,d),g=h.isDateDisabled(e,i,t,c);u&&!g||(l.classList.add("disabled"),l.style.opacity="0.4",l.style.cursor="not-allowed"),e===v[0]&&i===v[1]&&t===v[2]&&l.classList.add("today"),o?this.applyRangeHighlighting(l,e,i,t,s,a):r&&e===r[0]&&i===r[1]&&t===r[2]&&l.classList.add("selected"),this.showEvents&&this.addHolidayInfo(l,e,i,t),this.setupDayTooltips(l),m.appendChild(l)}t.appendChild(m)}applyRangeHighlighting(t,e,i,r,s,a){const o=[e,i,r];if(t.classList.remove("in-range","range-start","range-end"),s&&a){const e=h.compareDates(o,s)>=0&&h.compareDates(o,a)<=0;0===h.compareDates(o,s)?(t.classList.add("range-start"),0===h.compareDates(o,a)&&t.classList.add("range-end")):0===h.compareDates(o,a)?t.classList.add("range-end"):e&&t.classList.add("in-range")}else s&&!a&&0===h.compareDates(o,s)&&t.classList.add("range-start")}addHolidayInfo(t,e,i,r){let s=!1;if(5===this.persianDateClass.getDayOfWeek(e,i,r)&&(t.classList.add("friday"),s=!0),this.eventUtils.isHoliday(i,r,this.eventTypes,this.includeAllTypes)){t.classList.add("holiday"),s=!0;const e=this.eventUtils.getEvents(i,r,this.eventTypes,this.includeAllTypes);if(e.length>0){const i=c.createEventTooltip(e);t.appendChild(i)}}return s}setupDayTooltips(t){t.addEventListener("mouseenter",(()=>{const e=t.querySelector(".event-tooltip");e&&e.classList.add("tooltip-visible")})),t.addEventListener("mouseleave",(()=>{const e=t.querySelector(".event-tooltip");e&&e.classList.remove("tooltip-visible")}))}updateMonthYearSelectors(t,e,i){if(!t)return;const r=t.getElementById("month-select-value"),s=t.getElementById("year-select-value");r&&(r.textContent=c.getPersianMonths()[i-1]),s&&(s.textContent=p.toPersianNum(e)),t.querySelectorAll(".month-select-content .select-item").forEach((t=>{t.getAttribute("data-value")===""+i?t.classList.add("selected"):t.classList.remove("selected")})),t.querySelectorAll(".year-select-content .select-item").forEach((t=>{t.getAttribute("data-value")===""+e?t.classList.add("selected"):t.classList.remove("selected")}))}setupMonthYearSelectors(t,e,i,r,s){if(!t)return;const a=t.getElementById("month-select-trigger"),o=t.getElementById("year-select-trigger"),n=t.getElementById("month-select-value"),d=t.getElementById("year-select-value"),h=t.getElementById("month-select-content"),l=t.getElementById("year-select-content");if(!(a&&o&&n&&d&&h&&l))return;h.innerHTML="",l.innerHTML="";const u=c.createMonthOptions(i,r);h.appendChild(u);const g=c.createYearOptions(e,s,p.toPersianNum);l.appendChild(g),a.addEventListener("click",(e=>{e.stopPropagation(),this.toggleDropdown(h,t)})),o.addEventListener("click",(e=>{e.stopPropagation(),this.toggleDropdown(l,t)})),h.addEventListener("click",(t=>{t.stopPropagation()})),l.addEventListener("click",(t=>{t.stopPropagation()}))}toggleDropdown(t,e){if(!t)return;const i=t.classList.contains("open");this.closeAllDropdowns(e),i||(t.classList.add("open"),requestAnimationFrame((()=>{const e=t.querySelector(".select-item.selected");e&&(t.scrollTop=Math.max(0,e.offsetTop-t.clientHeight/2+e.clientHeight/2))})))}closeAllDropdowns(t){t&&t.querySelectorAll(".select-content").forEach((t=>{t.classList.remove("open")}))}}const g=["Iran","AncientIran","International"];class v extends HTMLElement{static get observedAttributes(){return["placeholder","rtl","format","show-holidays","holiday-types","event-types","show-events","today-button-text","today-button-class","tomorrow-button-text","tomorrow-button-class","min-date","max-date","disabled-dates","range-mode","show-month-selector","show-year-selector","show-prev-button","show-next-button","show-today-button","show-tomorrow-button"]}constructor(t={}){super(),this.touchGestureHandler=""[0],this.jalaliYear=0,this.jalaliMonth=0,this.jalaliDay=0,this.selectedDate=""[0],this.isRangeMode=!1,this.rangeStart=""[0],this.rangeEnd=""[0],this.isSelectingRange=!1,this.showEvents=!0,this.eventTypes=[...g],this.includeAllTypes=!1,this.isTransitioning=!1,this._documentClickHandler=()=>{},this.format="YYYY/MM/DD",this.minDate=""[0],this.maxDate=""[0],this.disabledDatesFn=""[0],this.handleInputClick=t=>{t.stopPropagation(),this.toggleCalendar()},this.handleDocumentClick=t=>{this.calendar&&this.calendar.classList.contains("visible")&&(t.composedPath().includes(this)||(this.closeAllDropdowns(),this.toggleCalendar()))},this.options=t,this.eventUtils=d.getInstance(),this.calendarRenderer=new u(i,this.eventUtils,this.showEvents,this.eventTypes,this.includeAllTypes),this.initializeFromOptions(t),this.createShadowDOM()}initializeFromOptions(t){if(void 0!==t.showEvents&&(this.showEvents=t.showEvents),t.format&&(this.format=t.format),void 0!==t.rtl&&this.style.setProperty("--jdp-direction",t.rtl?"rtl":"ltr"),void 0!==t.rangeMode&&(this.isRangeMode=t.rangeMode),t.rangeStart&&(this.rangeStart=t.rangeStart),t.rangeEnd&&(this.rangeEnd=t.rangeEnd),t.minDate&&(this.minDate=t.minDate),t.maxDate&&(this.maxDate=t.maxDate),t.disabledDates)if("function"==typeof t.disabledDates)this.disabledDatesFn=t.disabledDates;else if("string"==typeof t.disabledDates){const e=window[t.disabledDates];"function"==typeof e&&(this.disabledDatesFn=e)}t.defaultDate&&(this.selectedDate=t.defaultDate,this.jalaliYear=t.defaultDate[0],this.jalaliMonth=t.defaultDate[1],this.jalaliDay=t.defaultDate[2]),t.showEvents&&t.eventTypes&&this.seteventTypes(t.eventTypes)}createShadowDOM(){const t=this.attachShadow({mode:"open"});this.render(t)}render(t){const e=this.getButtonConfig(),i=this.getVisibilityConfig();t.innerHTML='<style>:host{ --jdp-primary:#0891b2;--jdp-primary-hover:#0e7490;--jdp-primary-foreground:#ffffff; --jdp-background:#ffffff;--jdp-foreground:#1e293b;--jdp-muted:#f1f5f9;--jdp-muted-foreground:#64748b;--jdp-border:#e2e8f0;--jdp-ring:#0284c7; --jdp-holiday-color:#ef4444;--jdp-holiday-bg:#fee2e2;--jdp-holiday-hover-bg:#fecaca; --jdp-range-bg:rgba(8, 145, 178, 0.1);--jdp-range-color:var(--jdp-foreground);--jdp-range-start-bg:var(--jdp-primary);--jdp-range-start-color:var(--jdp-primary-foreground);--jdp-range-end-bg:var(--jdp-primary);--jdp-range-end-color:var(--jdp-primary-foreground); --jdp-font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;--jdp-font-size:14px;--jdp-line-height:1.5;--jdp-font-weight:400;--jdp-font-weight-medium:500;--jdp-day-name-font-size:12px;--jdp-day-name-font-weight:400;--jdp-day-font-size:13px;--jdp-day-font-weight:400;--jdp-month-year-font-size:14px;--jdp-month-year-font-weight:500; --jdp-spacing-xs:4px;--jdp-spacing-sm:8px;--jdp-spacing-md:16px;--jdp-spacing-lg:24px; --jdp-input-padding-x:14px;--jdp-input-padding-y:10px;--jdp-input-border-width:1px;--jdp-input-border-color:var(--jdp-border);--jdp-input-border-radius:var(--jdp-border-radius);--jdp-input-focus-ring-width:2px;--jdp-input-focus-ring-color:rgba(2, 132, 199, 0.25); --jdp-calendar-width:280px;--jdp-calendar-padding:var(--jdp-spacing-md);--jdp-calendar-border-width:1px;--jdp-calendar-border-color:var(--jdp-border);--jdp-calendar-border-radius:var(--jdp-border-radius);--jdp-calendar-shadow:0px 10px 38px -10px rgba(22, 23, 24, 0.35), 0px 10px 20px -15px rgba(22, 23, 24, 0.2);--jdp-calendar-z-index:99999; --jdp-nav-button-size:30px;--jdp-nav-button-bg:var(--jdp-muted);--jdp-nav-button-bg-hover:var(--jdp-border);--jdp-nav-button-border-radius:var(--jdp-border-radius);--jdp-nav-arrow-size:8px;--jdp-nav-arrow-thickness:2px;--jdp-nav-arrow-color:var(--jdp-foreground); --jdp-day-cell-size:32px;--jdp-day-cell-margin:1px;--jdp-day-cell-border-radius:var(--jdp-border-radius); --jdp-day-hover-bg:var(--jdp-muted);--jdp-day-selected-bg:var(--jdp-primary);--jdp-day-selected-color:var(--jdp-primary-foreground);--jdp-day-today-border-color:var(--jdp-primary);--jdp-day-today-border-width:1px;--jdp-day-disabled-opacity:0.4; --jdp-transition-duration:0.2s;--jdp-fade-from-y:-4px;--jdp-fade-from-y-reverse:4px;--jdp-month-transition-duration:0.3s; --jdp-border-radius:0.5rem;--jdp-direction:rtl;--jdp-header-gap:var(--jdp-spacing-xs); --jdp-select-container-gap:8px;--jdp-select-trigger-height:var(--jdp-nav-button-size);--jdp-select-trigger-bg:var(--jdp-muted);--jdp-select-trigger-max-width:110px;--jdp-select-month-trigger-max-width:var(--jdp-select-trigger-max-width);--jdp-select-year-trigger-max-width:var(--jdp-select-trigger-max-width);--jdp-select-dropdown-width:auto;--jdp-select-text-overflow:ellipsis; --jdp-scrollbar-width:4px;--jdp-scrollbar-track:transparent;--jdp-scrollbar-thumb:rgba(0, 0, 0, 0.15);--jdp-scrollbar-thumb-hover:rgba(0, 0, 0, 0.25);--jdp-scrollbar-border-radius:4px;}*{box-sizing:border-box;direction:var(--jdp-direction);}.picker-container{position:relative;display:inline-block;width:100%;font-family:var(--jdp-font-family);font-size:var(--jdp-font-size);line-height:var(--jdp-line-height);font-weight:var(--jdp-font-weight);}input{width:100%;padding:var(--jdp-input-padding-y) var(--jdp-input-padding-x);border-radius:var(--jdp-input-border-radius);border:var(--jdp-input-border-width) solid var(--jdp-input-border-color);font-size:var(--jdp-font-size);line-height:var(--jdp-line-height);font-family:inherit;background-color:var(--jdp-background);color:var(--jdp-foreground);cursor:pointer;outline:none;transition:all var(--jdp-transition-duration) ease;text-align:right;}input:focus{border-color:var(--jdp-ring);box-shadow:0 0 0 var(--jdp-input-focus-ring-width) var(--jdp-input-focus-ring-color);}.calendar{display:none;position:absolute;right:0;width:var(--jdp-calendar-width);background:var(--jdp-background);border:var(--jdp-calendar-border-width) solid var(--jdp-calendar-border-color);border-radius:var(--jdp-calendar-border-radius);box-shadow:var(--jdp-calendar-shadow);padding:var(--jdp-calendar-padding);text-align:center;z-index:var(--jdp-calendar-z-index);touch-action:manipulation;-webkit-user-select:none;user-select:none;transform:translateZ(0);will-change:transform;backface-visibility:hidden;contain:layout style;}.calendar.position-bottom{top:calc(100% + 5px);animation:fadeInFromTop var(--jdp-transition-duration) ease;}.calendar.position-top{bottom:calc(100% + 5px);animation:fadeInFromBottom var(--jdp-transition-duration) ease;}.calendar.visible{display:block;}@keyframes fadeInFromTop{from{opacity:0;transform:translateY(var(--jdp-fade-from-y));}to{opacity:1;transform:translateY(0);}}@keyframes fadeInFromBottom{from{opacity:0;transform:translateY(var(--jdp-fade-from-y-reverse));}to{opacity:1;transform:translateY(0);}}.header{display:flex;justify-content:space-between;align-items:center;margin-bottom:var(--jdp-spacing-md);gap:var(--jdp-header-gap, var(--jdp-spacing-xs));}.month-year{font-weight:var(--jdp-month-year-font-weight);font-size:var(--jdp-month-year-font-size);color:var(--jdp-foreground);transition:opacity var(--jdp-transition-duration) ease;}.month-year.fade{opacity:0;}.days-wrapper{position:relative;touch-action:pan-y;overflow:visible;z-index:1;contain:layout;isolation:isolate;}.days{display:grid;grid-template-columns:repeat(7, 1fr);transition:transform var(--jdp-month-transition-duration) ease, opacity var(--jdp-month-transition-duration) ease;will-change:transform, opacity;transform:translateZ(0);backface-visibility:hidden;position:relative;contain:layout;}.days.slide-left{animation:slideInLeft var(--jdp-month-transition-duration) ease;}.days.slide-right{animation:slideInRight var(--jdp-month-transition-duration) ease;}@keyframes slideInLeft{from{opacity:0;transform:translateX(-10%) translateZ(0);pointer-events:none;}to{opacity:1;transform:translateX(0) translateZ(0);pointer-events:auto;}}@keyframes slideInRight{from{opacity:0;transform:translateX(10%) translateZ(0);pointer-events:none;}to{opacity:1;transform:translateX(0) translateZ(0);pointer-events:auto;}}.day{position:relative;z-index:1;touch-action:manipulation;isolation:isolate;}.day:hover{z-index:2;}.nav-button{background:var(--jdp-nav-button-bg);border:none;border-radius:var(--jdp-nav-button-border-radius);width:var(--jdp-nav-button-size);height:var(--jdp-nav-button-size);cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all var(--jdp-transition-duration) ease;position:relative;touch-action:manipulation;will-change:transform, background-color;}.nav-button:hover{background:var(--jdp-nav-button-bg-hover);}.nav-button:active{transform:translateY(1px);}.nav-button::before{content:\'\';display:block;width:var(--jdp-nav-arrow-size);height:var(--jdp-nav-arrow-size);border-top:var(--jdp-nav-arrow-thickness) solid var(--jdp-nav-arrow-color);border-right:var(--jdp-nav-arrow-thickness) solid var(--jdp-nav-arrow-color);position:absolute;}.nav-button.prev::before{transform:rotate(45deg);right:11px;left:auto;}.nav-button.next::before{transform:rotate(225deg);left:11px;right:auto;}.day-names{display:grid;grid-template-columns:repeat(7, 1fr);margin-bottom:var(--jdp-spacing-sm);}.day-name{font-size:var(--jdp-day-name-font-size);font-weight:var(--jdp-day-name-font-weight);color:var(--jdp-muted-foreground);padding:var(--jdp-spacing-xs) 0;text-align:center;}.day{aspect-ratio:1/1;display:flex;align-items:center;justify-content:center;border-radius:var(--jdp-day-cell-border-radius);font-size:var(--jdp-day-font-size);font-weight:var(--jdp-day-font-weight);cursor:pointer;transition:var(--jdp-transition-duration) ease;margin:var(--jdp-day-cell-margin);position:relative;touch-action:manipulation;-webkit-tap-highlight-color:transparent;-webkit-user-select:none;user-select:none;}.day:hover:not(.empty):not(.disabled){background:var(--jdp-day-hover-bg);}.day.selected{background:var(--jdp-day-selected-bg);color:var(--jdp-day-selected-color);}.day.today:not(.selected){border:var(--jdp-day-today-border-width) solid var(--jdp-day-today-border-color);}.day.empty{cursor:default;}.day.disabled{opacity:var(--jdp-day-disabled-opacity);cursor:not-allowed;} .day.holiday:not(.selected){color:var(--jdp-holiday-color);background-color:var(--jdp-holiday-bg);font-weight:var(--jdp-font-weight-medium);}.day.holiday:hover:not(.selected):not(.disabled){background-color:var(--jdp-holiday-hover-bg);} .day.holiday.in-range{background-color:var(--jdp-range-bg);color:var(--jdp-range-color);}.day.holiday.range-start, .day.holiday.range-end{background-color:var(--jdp-range-start-bg);color:var(--jdp-range-start-color);}.day.friday{color:var(--jdp-holiday-color);}.event-tooltip{position:absolute;background:var(--jdp-background);border:1px solid var(--jdp-border);border-radius:var(--jdp-border-radius);padding:var(--jdp-spacing-sm);width:200px;box-shadow:var(--jdp-calendar-shadow);text-align:right;font-size:12px;opacity:0;visibility:hidden;transition:opacity var(--jdp-transition-duration) ease, visibility var(--jdp-transition-duration) ease;pointer-events:none;bottom:120%;right:0;transform:translateY(-5px);z-index:100001;}.event-tooltip.tooltip-visible{opacity:1;visibility:visible;pointer-events:auto;background:var(--jdp-background);} @media (max-width:768px){.event-tooltip{position:fixed;left:50%;top:50%;transform:translate(-50%, -50%);width:90%;max-width:300px;max-height:80vh;overflow-y:auto;bottom:auto;right:auto;background:var(--jdp-background);z-index:100001;}.event-tooltip::before{content:\'\';position:fixed;top:0;left:0;right:0;bottom:0;z-index:-1;}}.event-item{margin-bottom:4px;padding-bottom:4px;border-bottom:1px solid var(--jdp-border);color:var(--jdp-foreground);background:var(--jdp-background);}.event-item:last-child{margin-bottom:0;padding-bottom:0;border-bottom:none;}.event-item.holiday{color:var(--jdp-holiday-color);}.event-type-label{display:inline-block;font-size:10px;padding:1px 4px;border-radius:3px;margin-right:4px;background-color:var(--jdp-muted);color:var(--jdp-muted-foreground);} .footer{margin-top:var(--jdp-spacing-md);display:flex;justify-content:space-between;}.date-nav-button{background:var(--jdp-muted);border:none;border-radius:var(--jdp-border-radius);padding:var(--jdp-spacing-xs) var(--jdp-spacing-md);font-family:inherit;font-size:var(--jdp-font-size);color:var(--jdp-foreground);cursor:pointer;transition:all var(--jdp-transition-duration) ease;touch-action:manipulation;-webkit-tap-highlight-color:transparent;}.date-nav-button:hover{background:var(--jdp-nav-button-bg-hover);}.date-nav-button:active{transform:translateY(1px);} :host .selectors-container{display:flex;gap:var(--jdp-select-container-gap, 8px);position:relative;align-items:var(--jdp-select-container-align, center);justify-content:var(--jdp-select-container-justify, space-between);width:100%;max-width:calc(100% - var(--jdp-nav-button-size) * 2 - var(--jdp-spacing-sm));margin:0 var(--jdp-spacing-xs);}:host .custom-select{position:relative;user-select:none;width:100%;margin:0 var(--jdp-spacing-xs, 2px);}:host .month-select{margin-left:var(--jdp-month-select-margin-left, 0);margin-right:var(--jdp-month-select-margin-right, 0);}:host .year-select{margin-left:var(--jdp-year-select-margin-left, 0);margin-right:var(--jdp-year-select-margin-right, 0);}:host .select-trigger{display:flex;align-items:center;justify-content:var(--jdp-select-trigger-justify, center);gap:0 4px;width:100%;height:var(--jdp-select-trigger-height, var(--jdp-nav-button-size));min-height:var(--jdp-nav-button-size);background-color:var(--jdp-select-trigger-bg, var(--jdp-muted));border:var(--jdp-select-trigger-border-width, 1px) solid var(--jdp-select-trigger-border-color, var(--jdp-border));border-radius:var(--jdp-select-trigger-border-radius, var(--jdp-border-radius));color:var(--jdp-select-trigger-color, var(--jdp-foreground));font-family:inherit;font-size:var(--jdp-select-trigger-font-size, var(--jdp-font-size));line-height:1;padding:0 var(--jdp-select-trigger-padding-x, 0);cursor:pointer;transition:all var(--jdp-transition-duration) ease;text-align:var(--jdp-select-trigger-text-align, center);min-width:var(--jdp-select-trigger-min-width, initial);outline:none;font-weight:var(--jdp-select-trigger-font-weight, 500);box-sizing:border-box;max-width:var(--jdp-select-trigger-max-width, 110px);}:host .month-select .select-trigger{max-width:var(--jdp-select-month-trigger-max-width, var(--jdp-select-trigger-max-width));}:host .year-select .select-trigger{max-width:var(--jdp-select-year-trigger-max-width, var(--jdp-select-trigger-max-width));}:host .select-trigger span:first-child{white-space:nowrap;overflow:var(--jdp-select-trigger-overflow, visible);text-overflow:var(--jdp-select-text-overflow, ellipsis);max-width:calc(100% - 24px);display:inline-block;text-align:center;flex:1;}:host .select-trigger:hover{background-color:var(--jdp-select-trigger-bg-hover, rgba(0, 0, 0, 0.05));border-color:var(--jdp-select-trigger-border-hover, var(--jdp-border));}:host .select-trigger:focus-visible{outline:2px solid var(--jdp-select-trigger-focus-ring-color, var(--jdp-ring));outline-offset:var(--jdp-select-trigger-focus-ring-offset, 2px);}:host .select-icon{margin-left:var(--jdp-select-icon-margin, var(--jdp-spacing-xs));display:var(--jdp-select-icon-display, none);justify-content:center;align-items:center;transition:transform 0.2s ease;width:var(--jdp-select-icon-size, 12px);height:var(--jdp-select-icon-size, 12px);opacity:var(--jdp-select-icon-opacity, 0.7);flex-shrink:0;}:host .select-icon svg{width:var(--jdp-select-icon-size, 12px);height:var(--jdp-select-icon-size, 12px);}:host .select-content.open .select-icon{transform:rotate(180deg);}:host .select-content{position:var(--jdp-select-content-position, absolute);top:calc(100% + var(--jdp-select-content-top-offset, 5px));left:0;width:var(--jdp-select-dropdown-width, 100%);min-width:100%;background-color:var(--jdp-select-content-bg, var(--jdp-background));border:var(--jdp-select-content-border-width, 1px) solid var(--jdp-select-content-border-color, var(--jdp-border));border-radius:var(--jdp-select-content-border-radius, var(--jdp-border-radius));box-shadow:var(--jdp-select-content-shadow, 0 4px 8px rgba(0,0,0,0.1));z-index:var(--jdp-select-content-z-index, 100000);overflow-y:auto;max-height:var(--jdp-select-content-max-height, 200px);display:none;padding:var(--jdp-select-content-padding-y, 0.25rem) var(--jdp-select-content-padding-x, 0);scroll-behavior:smooth; scrollbar-width:var(--jdp-scrollbar-width-size, none);scrollbar-color:var(--jdp-scrollbar-thumb, rgba(0, 0, 0, 0.15)) var(--jdp-scrollbar-track, transparent);} :host .select-content::-webkit-scrollbar{width:var(--jdp-scrollbar-width, 4px);}:host .select-content::-webkit-scrollbar-track{background:var(--jdp-scrollbar-track, transparent);border-radius:var(--jdp-scrollbar-border-radius, 4px);}:host .select-content::-webkit-scrollbar-thumb{background-color:var(--jdp-scrollbar-thumb, rgba(0, 0, 0, 0.15));border-radius:var(--jdp-scrollbar-border-radius, 4px);}:host .select-content::-webkit-scrollbar-thumb:hover{background-color:var(--jdp-scrollbar-thumb-hover, rgba(0, 0, 0, 0.25));}:host .select-content.open{display:block;animation:fadeInSelect var(--jdp-select-content-animation-duration, var(--jdp-transition-duration)) ease;}:host .month-select-content{width:var(--jdp-select-month-width, var(--jdp-select-dropdown-width, auto));min-width:100%;}:host .year-select-content{width:var(--jdp-select-year-width, var(--jdp-select-dropdown-width, auto));min-width:100%;}:host .select-item{padding:var(--jdp-select-item-padding-y, 0.5rem) var(--jdp-select-item-padding-x, 0.75rem);cursor:pointer;transition:background-color var(--jdp-transition-duration) ease;border-radius:var(--jdp-select-item-border-radius, var(--jdp-select-trigger-border-radius, var(--jdp-border-radius)));margin:var(--jdp-select-item-margin, 0 0.25rem);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:var(--jdp-select-item-max-width, 100%);box-sizing:border-box;text-align:var(--jdp-select-item-text-align, center);}:host .select-item:hover{background-color:var(--jdp-select-item-hover-bg, var(--jdp-day-hover-bg));}:host .select-item.selected{background-color:var(--jdp-select-item-selected-bg, var(--jdp-primary));color:var(--jdp-select-item-selected-color, var(--jdp-primary-foreground));font-weight:var(--jdp-select-item-selected-font-weight, var(--jdp-font-weight-medium));border-radius:var(--jdp-select-item-selected-border-radius, var(--jdp-select-trigger-border-radius, var(--jdp-border-radius)));}@keyframes fadeInSelect{from{opacity:0;transform:translateY(-5px);}to{opacity:1;transform:translateY(0);}} :host([rtl="!0"]) .select-icon, :host([dir="rtl"]) .select-icon{margin-left:0;margin-right:var(--jdp-select-icon-margin, var(--jdp-spacing-xs));}:host([rtl="!0"]) .select-item, :host([dir="rtl"]) .select-item{text-align:var(--jdp-select-item-text-align, right);} @media (prefers-color-scheme:dark){:host{--jdp-scrollbar-thumb:rgba(124, 124, 124, 0.15);--jdp-scrollbar-thumb-hover:rgba(41, 41, 41, 0.25);}} :host(.dark-theme){--jdp-scrollbar-thumb:rgba(124, 124, 124, 0.15);--jdp-scrollbar-thumb-hover:rgba(41, 41, 41, 0.25);} .day.in-range{background-color:var(--jdp-range-bg);color:var(--jdp-range-color);position:relative;z-index:1;border-radius:0;}.day.range-start, .day.range-end{background-color:var(--jdp-range-start-bg);color:var(--jdp-range-start-color);position:relative;z-index:2;}.day.range-start{border-radius:0 var(--jdp-border-radius) var(--jdp-border-radius) 0;}.day.range-end{border-radius:var(--jdp-border-radius) 0 0 var(--jdp-border-radius);} :host([rtl="!0"]) .day.range-start, :host([dir="rtl"]) .day.range-start{border-radius:var(--jdp-border-radius) 0 0 var(--jdp-border-radius);}:host([rtl="!0"]) .day.range-end, :host([dir="rtl"]) .day.range-end{border-radius:0 var(--jdp-border-radius) var(--jdp-border-radius) 0;} .day.range-start.range-end{border-radius:var(--jdp-border-radius);} .day.in-range:not(.range-start):not(.range-end){background-color:var(--jdp-range-bg);color:var(--jdp-range-color);border-radius:0;} .day.disabled.in-range{opacity:0.4;background-color:var(--jdp-range-bg);color:var(--jdp-range-color);border-radius:0;} .day.holiday.in-range:not(.range-start):not(.range-end){background-color:var(--jdp-range-bg);color:var(--jdp-range-color);border-radius:0;}.day.holiday.range-start, .day.holiday.range-end{background-color:var(--jdp-range-start-bg);color:var(--jdp-range-start-color);}</style> '+c.generateComponentHTML(i,e)}async connectedCallback(){try{if(!this.shadowRoot)return;this.initializeDomReferences(),this.initializeCurrentDate(),d.isInitialized()||await d.initialize(),this.initializeUIComponents(),this.addEventListeners(),this.initTouchGestures(),this.renderCalendar()}catch(t){}}disconnectedCallback(){this._documentClickHandler&&document.removeEventListener("click",this._documentClickHandler),v.openCalendarInstance===this&&(v.openCalendarInstance=""[0]),this.touchGestureHandler&&this.touchGestureHandler.destroy(),this.removeEventListeners()}removeEventListeners(){if(!this.shadowRoot)return;this.input&&this.input.removeEventListener("click",this.handleInputClick),this.calendar&&this.calendar.removeEventListener("click",(t=>t.stopPropagation())),this.daysContainer&&this.daysContainer.removeEventListener("click",this.handleDayClick.bind(this));const t=this.shadowRoot.getElementById("prev-month"),e=this.shadowRoot.getElementById("next-month"),i=this.shadowRoot.getElementById("today-button"),r=this.shadowRoot.getElementById("tomorrow-button");t&&(t.removeEventListener("click",(()=>this.changeMonth(-1))),t.removeEventListener("touchstart",(t=>t.stopPropagation()))),e&&(e.removeEventListener("click",(()=>this.changeMonth(1))),e.removeEventListener("touchstart",(t=>t.stopPropagation()))),i&&i.removeEventListener("click",(()=>this.goToToday())),r&&r.removeEventListener("click",(()=>this.goToTomorrow()))}initializeDomReferences(){if(this.shadowRoot){if(this.input=this.shadowRoot.getElementById("date-input"),this.calendar=this.shadowRoot.getElementById("calendar"),this.daysContainer=this.shadowRoot.getElementById("days-container"),this.dayNamesContainer=this.shadowRoot.getElementById("day-names"),!(this.input&&this.calendar&&this.daysContainer&&this.dayNamesContainer))throw Error("Failed to initialize required elements");if(this.options.placeholder)this.input.placeholder=this.options.placeholder;else{const t=this.getAttribute("placeholder");t&&(this.input.placeholder=t)}}}initializeCurrentDate(){const t=new Date,e=i.gregorianToJalali(t.getFullYear(),t.getMonth()+1,t.getDate());this.jalaliYear=e[0],this.jalaliMonth=e[1],this.jalaliDay=e[2],this.selectedDate=""[0]}initializeUIComponents(){c.initializeDayNames(this.dayNamesContainer),this.setupMonthYearSelectors()}setupMonthYearSelectors(){this.shadowRoot&&this.calendarRenderer.setupMonthYearSelectors(this.shadowRoot,this.jalaliYear,this.jalaliMonth,this.handleMonthChange.bind(this),this.handleYearChange.bind(this))}initTouchGestures(){if(!this.calendar||!this.shadowRoot)return;this.touchGestureHandler=new l(this.calendar,this.changeMonth.bind(this),(()=>this.isTransitioning));const t=this.shadowRoot.getElementById("prev-month"),e=this.shadowRoot.getElementById("next-month");t&&l.preventTouchPropagation(t),e&&l.preventTouchPropagation(e)}getButtonConfig(){return{todayButtonText:this.getAttribute("today-button-text")||"امروز",todayButtonClass:this.getAttribute("today-button-class")||"",tomorrowButtonText:this.getAttribute("tomorrow-button-text")||"فردا",tomorrowButtonClass:this.getAttribute("tomorrow-button-class")||""}}getVisibilityConfig(){return{showMonthSelector:"!1"!==this.getAttribute("show-month-selector"),showYearSelector:"!1"!==this.getAttribute("show-year-selector"),showPrevButton:"!1"!==this.getAttribute("show-prev-button"),showNextButton:"!1"!==this.getAttribute("show-next-button"),showTodayButton:"!1"!==this.getAttribute("show-today-button"),showTomorrowButton:"!1"!==this.getAttribute("show-tomorrow-button")}}renderCalendar(){if(this.shadowRoot&&this.daysContainer&&(this.calendarRenderer.updateMonthYearSelectors(this.shadowRoot,this.jalaliYear,this.jalaliMonth),this.calendarRenderer.renderCalendar(this.daysContainer,this.jalaliYear,this.jalaliMonth,this.selectedDate,this.rangeStart,this.rangeEnd,this.isRangeMode,this.minDate,this.maxDate,this.disabledDatesFn),this.isRangeMode)){const t=this.shadowRoot.querySelector(".footer");t&&t.remove()}}changeMonth(t){if(this.isTransitioning)return;this.isTransitioning=!0;const e=this.daysContainer,i=t>0?"slide-left":"slide-right";e.classList.add(i),this.jalaliMonth=Number(this.jalaliMonth)+t,this.jalaliMonth<1?(this.jalaliMonth=12,this.jalaliYear--):this.jalaliMonth>12&&(this.jalaliMonth=1,this.jalaliYear++),requestAnimationFrame((()=>{setTimeout((()=>{this.calendarRenderer.updateMonthYearSelectors(this.shadowRoot,this.jalaliYear,this.jalaliMonth),e.innerHTML="",this.renderCalendar(),requestAnimationFrame((()=>{e.classList.remove(i),setTimeout((()=>{this.isTransitioning=!1}),50)}))}),200)}))}handleMonthChange(t,e){this.jalaliMonth!==t&&(this.jalaliMonth=t,this.renderCalendar())}handleYearChange(t){if(this.jalaliYear===t)return;const e=this.jalaliYear;this.jalaliYear=t,e!==t&&this.eventUtils.refreshEvents(),this.renderCalendar()}navigateToDate(t){const e=i.gregorianToJalali(t.getFullYear(),t.getMonth()+1,t.getDate()),r=this.jalaliYear;this.jalaliYear=e[0],this.jalaliMonth=e[1],r!==this.jalaliYear&&this.eventUtils.refreshEvents(),this.renderCalendar(),this.selectDate(e[2])}goToToday(){this.navigateToDate(new Date)}goToTomorrow(){const t=new Date;t.setDate(t.getDate()+1),this.navigateToDate(t)}selectDate(t){if(h.isDateDisabled(this.jalaliYear,this.jalaliMonth,t,this.disabledDatesFn)||!h.isDateInRange(this.jalaliYear,this.jalaliMonth,t,this.minDate,this.maxDate))return;this.jalaliDay=t,this.selectedDate=[this.jalaliYear,this.jalaliMonth,this.jalaliDay],this.formatAndSetValue();const e=this.eventUtils.getEvents(this.jalaliMonth,t,this.eventTypes,this.includeAllTypes),r=p.formatDate(this.selectedDate,this.format),s=i.jalaliToGregorian(this.jalaliYear,this.jalaliMonth,this.jalaliDay),a=h.jalaliToISOString(this.selectedDate,i);this.dispatchEvent(new CustomEvent("change",{detail:{jalali:this.selectedDate,gregorian:s,isHoliday:this.eventUtils.isHoliday(this.jalaliMonth,t,this.eventTypes,this.includeAllTypes),events:e,formattedDate:r,isoString:a},bubbles:!0})),this.closeAllDropdowns(),this.toggleCalendar(),this.renderCalendar()}formatAndSetValue(){if(this.isRangeMode)return this.rangeStart&&this.rangeEnd?void(this.input.value=p.formatDateRange(this.rangeStart,this.rangeEnd,this.format)):void(this.input.value="");this.input.value=this.selectedDate?p.formatDate(this.selectedDate,this.format):""}toggleCalendar(){this.closeAllDropdowns(),this.calendar.classList.contains("visible")?(this.calendar.classList.remove("visible","position-bottom","position-top"),v.openCalendarInstance===this&&(v.openCalendarInstance=""[0])):(v.openCalendarInstance&&v.openCalendarInstance!==this&&v.openCalendarInstance.toggleCalendar(),this.positionCalendar(),this.calendar.classList.add("visible"),v.openCalendarInstance=this)}positionCalendar(){if(!this.input||!this.calendar)return;this.calendar.classList.remove("position-bottom","position-top");const t=this.input.getBoundingClientRect(),e=window.innerHeight;this.calendar.classList.add("position-bottom");const i=this.calendar.style.visibility,r=this.calendar.style.display;this.calendar.style.visibility="hidden",this.calendar.style.display="block";const s=this.calendar.offsetHeight,a=e-t.bottom;if(a<s){const e=t.top;(e>a||e>=s)&&(this.calendar.classList.remove("position-bottom"),this.calendar.classList.add("position-top"))}this.calendar.style.visibility=i,this.calendar.style.display=r}seteventTypes(t){if("string"==typeof t){if("all"===t.toLowerCase())return this.includeAllTypes=!0,void(this.eventTypes=[...this.eventUtils.getEventTypes()]);try{const e=JSON.parse(t);this.eventTypes=Array.isArray(e)?e:t.split(",").map((t=>t.trim())).filter(Boolean)}catch(e){this.eventTypes=t.split(",").map((t=>t.trim())).filter(Boolean)}}else this.eventTypes=Array.isArray(t)?[...t]:[...g];this.includeAllTypes=!1,this.calendar&&this.renderCalendar()}geteventTypes(){return[...this.eventTypes]}isShowingAllTypes(){return this.includeAllTypes}setValue(t,e,i){this.selectedDate=[t,e,i],this.jalaliYear=t,this.jalaliMonth=e,this.jalaliDay=i,this.formatAndSetValue(),this.renderCalendar()}getValue(){return this.selectedDate?[...this.selectedDate]:""[0]}isSelectedDateHoliday(){return!!this.selectedDate&&this.eventUtils.isHoliday(this.selectedDate[1],this.selectedDate[2],this.eventTypes,this.includeAllTypes)}getSelectedDateEvents(){return this.selectedDate?[...this.eventUtils.getEvents(this.selectedDate[1],this.selectedDate[2],this.eventTypes,this.includeAllTypes)]:[]}clear(){this.isRangeMode?(this.rangeStart=""[0],this.rangeEnd=""[0]):this.selectedDate=""[0],this.input.value="",this.renderCalendar()}setMinDate(t,e,i){this.minDate=[t,e,i],this.calendar&&this.renderCalendar()}setMaxDate(t,e,i){this.maxDate=[t,e,i],this.calendar&&this.renderCalendar()}setDisabledDatesFn(t){this.disabledDatesFn=t,this.renderCalendar()}open(){this.calendar.classList.contains("visible")||this.toggleCalendar()}close(){this.calendar.classList.contains("visible")&&this.toggleCalendar()}setRange(t,e){this.rangeStart=t,this.rangeEnd=e,this.isRangeMode=!0,this.jalaliYear=t[0],this.jalaliMonth=t[1],this.calendarRenderer.updateMonthYearSelectors(this.shadowRoot,this.jalaliYear,this.jalaliMonth),this.formatAndSetValue(),this.renderCalendar()}getRange(){return{start:this.rangeStart?[...this.rangeStart]:""[0],end:this.rangeEnd?[...this.rangeEnd]:""[0]}}closeAllDropdowns(){this.shadowRoot&&this.shadowRoot.querySelectorAll(".select-content").forEach((t=>{t.classList.remove("open")}))}addEventListeners(){this.shadowRoot&&this.input&&this.calendar&&(this.input.addEventListener("click",this.handleInputClick),this.setupNavigationButtons(),this.calendar.addEventListener("click",(t=>t.stopPropagation())),this.daysContainer.addEventListener("click",this.handleDayClick.bind(this)),this.calendar.addEventListener("click",(t=>{const e=t.target;e.closest(".select-trigger")||e.closest(".select-content")||this.closeAllDropdowns()})),this._documentClickHandler=this.handleDocumentClick.bind(this),document.addEventListener("click",this._documentClickHandler))}handleDayClick(t){const e=t.target.closest(".day");if(!e||e.classList.contains("empty")||e.classList.contains("disabled")||h.isDateDisabled(this.jalaliYear,this.jalaliMonth,parseInt(e.textContent||"0"),this.disabledDatesFn))return;t.stopPropagation();const i=e.textContent;if(!i)return;const r=p.fromPersianNum(i);isNaN(r)||this.handleRangeSelection(r)}setupNavigationButtons(){if(!this.shadowRoot)return;const t=this.shadowRoot.getElementById("prev-month"),e=this.shadowRoot.getElementById("next-month"),i=this.shadowRoot.getElementById("today-button"),r=this.shadowRoot.getElementById("tomorrow-button"),s=(t,e)=>{t&&t.addEventListener("click",(t=>{t.stopPropagation(),this.closeAllDropdowns(),e()}))};s(t,(()=>this.changeMonth(-1))),s(e,(()=>this.changeMonth(1))),s(i,(()=>this.goToToday())),s(r,(()=>this.goToTomorrow()))}handleRangeSelection(t){if(!this.isRangeMode){if(h.isDateDisabled(this.jalaliYear,this.jalaliMonth,t,this.disabledDatesFn))return;return void this.selectDate(t)}const e=[this.jalaliYear,this.jalaliMonth,t];if(h.isDateInRange(this.jalaliYear,this.jalaliMonth,t,this.minDate,this.maxDate)&&!h.isDateDisabled(this.jalaliYear,this.jalaliMonth,t,this.disabledDatesFn)){if(this.isSelectingRange){this.rangeEnd=e,this.isSelectingRange=!1,this.rangeStart&&this.rangeEnd&&h.compareDates(this.rangeStart,this.rangeEnd)>0&&([this.rangeStart,this.rangeEnd]=[this.rangeEnd,this.rangeStart]),this.formatAndSetValue();const t=this.rangeStart?h.jalaliToISOString(this.rangeStart,i):""[0],r=this.rangeEnd?h.jalaliToISOString(this.rangeEnd,i):""[0],s=this.rangeStart?i.jalaliToGregorian(this.rangeStart[0],this.rangeStart[1],this.rangeStart[2]):""[0],a=this.rangeEnd?i.jalaliToGregorian(this.rangeEnd[0],this.rangeEnd[1],this.rangeEnd[2]):""[0];this.dispatchEvent(new CustomEvent("change",{detail:{range:{start:this.rangeStart,end:this.rangeEnd,startISOString:t,endISOString:r,startGregorian:s,endGregorian:a},isRange:!0},bubbles:!0})),this.closeAllDropdowns(),this.toggleCalendar()}else this.rangeStart=e,this.rangeEnd=""[0],this.isSelectingRange=!0;this.renderCalendar()}}attributeChangedCallback(t,e,i){if(e!==i&&this.shadowRoot)switch(t){case"placeholder":this.input&&(this.input.placeholder=i||"");break;case"rtl":this.style.setProperty("--jdp-direction",i!==""[0]&&"!1"!==i?"rtl":"ltr");break;case"show-holidays":case"show-events":this.showEvents=i!==""[0]&&"!1"!==i,this.calendar&&this.renderCalendar();break;case"holiday-types":case"event-types":i?this.seteventTypes(i):(this.eventTypes=[...g],this.includeAllTypes=!1),this.calendar&&this.renderCalendar();break;case"format":i&&p.isValidFormat(i)&&(this.format=i,this.selectedDate&&this.formatAndSetValue());break;case"min-date":if(i)try{const[t,e,r]=JSON.parse(i);this.setMinDate(t,e,r)}catch(t){}else this.minDate=""[0];this.calendar&&this.renderCalendar();break;case"max-date":if(i)try{const[t,e,r]=JSON.parse(i);this.setMaxDate(t,e,r)}catch(t){}else this.maxDate=""[0];this.calendar&&this.renderCalendar();break;case"disabled-dates":if(i){let t=""[0];try{t="function"==typeof i?i:"function"==typeof this[i]?this[i]:window[i]}catch(t){}"function"==typeof t&&(this.disabledDatesFn=t)}else this.disabledDatesFn=""[0];this.calendar&&this.renderCalendar();break;case"today-button-text":case"tomorrow-button-text":this.updateButtonText(t,i);break;case"today-button-class":case"tomorrow-button-class":this.updateButtonClass(t,i);break;case"range-mode":this.isRangeMode=i!==""[0]&&"!1"!==i,this.calendar&&this.renderCalendar();break;case"show-month-selector":case"show-year-selector":case"show-prev-button":case"show-next-button":case"show-today-button":case"show-tomorrow-button":this.shadowRoot&&(this.render(this.shadowRoot),this.initializeDomReferences(),this.initializeUIComponents(),this.addEventListeners(),this.renderCalendar())}}updateButtonText(t,e){if(!this.shadowRoot)return;const i="today-button-text"===t?"امروز":"فردا",r=this.shadowRoot.getElementById("today-button-text"===t?"today-button":"tomorrow-button");r&&(r.textContent=e||i)}updateButtonClass(t,e){if(!this.shadowRoot)return;const i="today-button-class"===t?"today-button":"tomorrow-button",r=this.shadowRoot.getElementById("today-button-class"===t?"today-button":"tomorrow-button");r&&(r.className="date-nav-button "+i,e&&e.split(" ").forEach((t=>{t.trim()&&r.classList.add(t.trim())})))}}if(v.openCalendarInstance=""[0],"void 0"!=typeof window&&"void 0"!=typeof customElements&&!customElements.get("persian-datepicker-element"))try{customElements.define("persian-datepicker-element",v)}catch(t){}const b=v;return e.default})()));