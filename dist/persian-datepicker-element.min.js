var t,n;t="undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:this,n=()=>(()=>{"use strict";function t(t,n,e){if(1>n||n>12||1>e||e>30)throw Error("Invalid Hijri date");return(t=>{const n=Math.floor(t+.5),e=Math.floor((n-1867216.25)/36524.25),r=n+1+e-Math.floor(e/4)+1524,i=Math.floor((r-122.1)/365.25),a=Math.floor(365.25*i),o=Math.floor((r-a)/30.6001),s=Math.floor(r-a-Math.floor(30.6001*o));let d=o-1-12*Math.floor(o/14),l=i-4715-Math.floor((7+d)/10);return 1>d&&(d+=12,l-=1),[l,d,s]})(Math.floor(354.367*(t-1))+Math.floor(29.5*(n-1))+(e-1)+1948439.5)}function n(t,n,e){const r=[31,28,31,30,31,30,31,31,30,31,30,31],i=[31,31,31,31,31,31,30,30,30,30,30,29];t=parseInt(""+t),n=parseInt(""+n),e=parseInt(""+e),r[1]=t%4==0&&t%100!=0||t%400==0?29:28;let a=e;for(let t=0;n-1>t;t++)a+=r[t];const o=Math.floor(1461*(t+Math.floor((n-8)/6)+100100)/4)+Math.floor(153*((n+9)%12+1)/5)+e-34840408,s=o%1461,d=Math.floor(o/1461)-2820+474;let l=s;366>l||(l-=366,l%=365);let h=0,c=l;for(;c>=i[h];)c-=i[h],h++;return[d,h+1,c+1]}function e(e,r,i){const[a,o,s]=t(e,r,i);return n(a,o,s)}async function r(){if(c)return u;const t=new Date,n=o.gregorianToJalali(t.getFullYear(),t.getMonth()+1,t.getDate())[0];if(p!==n){c=!0;try{const t=await fetch("data/events.json");if(!t.ok)throw Error("HTTP error! status: "+t.status);h=await t.json();const e=(()=>{try{let t=[];if(h&&Array.isArray(h["Persian Calendar"])&&(t=[...h["Persian Calendar"].map((t=>({title:t.title,month:t.month,day:t.day,type:t.type,holiday:t.holiday})))]),h&&Array.isArray(h["Hijri Calendar"])){const n=h["Hijri Calendar"].map((t=>{const n=s.hijriToJalali(t.year,t.month,t.day);return{title:t.title,month:n[1],day:n[2],type:t.type,holiday:t.holiday,hijri:{year:t.year,month:t.month,day:t.day}}}));t=[...t,...n]}return t}catch(t){return[...d]}})();l=[...e],p=n}catch(t){l=[...d]}finally{c=!1,u=null}}}var i,a={d(t,n){for(var e in n)a.o(n,e)&&!a.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:n[e]})},o(t,n){return{}.hasOwnProperty.call(t,n)}};a.d(i={},{default:()=>m});const o={g_days_in_month:[31,28,31,30,31,30,31,31,30,31,30,31],j_days_in_month:[31,31,31,31,31,31,30,30,30,30,30,29],jalaliToGregorian(t,n,e){const r=(t=parseInt(""+t))-979,i=(n=parseInt(""+n))-1,a=(e=parseInt(""+e))-1;let o=365*r+8*Math.floor(r/33)+Math.floor((r%33+3)/4);for(let t=0;i>t;++t)o+=this.j_days_in_month[t];o+=a;let s=o+79,d=1600+400*Math.floor(s/146097);s%=146097;let l=!0;36525>s||(s--,d+=100*Math.floor(s/36524),s%=36524,365>s?l=!1:s++),d+=4*Math.floor(s/1461),s%=1461,366>s||(l=!1,s--,d+=Math.floor(s/365),s%=365);let h=0;for(;s>=this.g_days_in_month[h]+(1===h&&l?1:0);h++)s-=this.g_days_in_month[h]+(1===h&&l?1:0);return[d,h+1,s+1]},gregorianToJalali(t,n,e){const r=(t=parseInt(""+t))-1600,i=(n=parseInt(""+n))-1,a=(e=parseInt(""+e))-1;let o=365*r+Math.floor((r+3)/4)-Math.floor((r+99)/100)+Math.floor((r+399)/400);for(let t=0;i>t;++t)o+=this.g_days_in_month[t];i>1&&(r%4==0&&r%100!=0||r%400==0)&&o++,o+=a;let s=o-79;const d=Math.floor(s/12053);s%=12053;let l=979+33*d+4*Math.floor(s/1461);s%=1461,366>s||(l+=Math.floor((s-1)/365),s=(s-1)%365);let h=0;for(;11>h&&s>=this.j_days_in_month[h];++h)s-=this.j_days_in_month[h];return[l,h+1,s+1]},isLeapJalaliYear:t=>[1,5,9,13,17,22,26,30].includes(t%33),getDaysInMonth(t,n){return 1>n||n>12?0:n>6?n>11?this.isLeapJalaliYear(t)?30:29:30:31},getMonthName:t=>["فروردین","اردیبهشت","خرداد","تیر","مرداد","شهریور","مهر","آبان","آذر","دی","بهمن","اسفند"][t-1],getDayOfWeek(t,n,e){const r=this.jalaliToGregorian(t,n,e);return new Date(r[0],r[1]-1,r[2]).getDay()},getDaysInYear(t){return this.isLeapJalaliYear(t)?366:365},isValidDate(t,n,e){return!(0>t||1>n||n>12||1>e||e>this.getDaysInMonth(t,n))}},s={hijriToGregorian:t,gregorianToJalali:n,hijriToJalali:e,getHijriEventDateInJalaliYear(t,n,r){const i=Math.floor(t-621.5+.74*(t-621.5))-202;for(let a=0;1>=a;a++)try{const o=i+a,[s,d,l]=e(o,n,r);if(s===t)return[d,l]}catch(t){}return null},getCurrentHijriDate(){const t=new Date,n=t.getFullYear(),e=t.getMonth()+1,r=t.getDate(),i=Math.floor(1461*(n+4800+(e-14)/12)/4+367*(e-2-(e-14)/12*12)/12-(n+4900+(e-14)/12)/100*3/4+r-32075)-1948440+10632,a=Math.floor((i-1)/10631),o=i-10631*a+354,s=Math.floor((10985-o)/5316)*Math.floor(50*o/17719)+Math.floor(o/5670)*Math.floor(43*o/15238),d=o-Math.floor((30-s)/15)*Math.floor(17719*s/50)-Math.floor(s/16)*Math.floor(15238*s/43)+29,l=Math.floor(24*d/709);return[30*a+s-30,l,d-Math.floor(709*l/24)]}},d=[];let l=[...d],h={"Persian Calendar":[],"Hijri Calendar":[],Source:{name:"Fallback Data",url:""}},c=!1,p=null,u=null;const g={getAllEvents(t,n=!1){let e=[...l];return t&&t.length>0&&!n&&(e=e.filter((n=>t.includes(n.type)))),e},getEvents(t,n,e,r=!1){return this.getAllEvents(e,r).filter((e=>e.month===t&&e.day===n))},isHoliday(t,n,e,r=!1){return this.getEvents(t,n,e,r).some((t=>!0===t.holiday))},getHolidayTitles(t,n,e,r=!1){return this.getEvents(t,n,e,r).filter((t=>!0===t.holiday)).map((t=>t.title))},getAllEventTitles(t,n,e,r=!1){return this.getEvents(t,n,e,r).map((t=>t.title))},getEventsByType(t,n=!1,e=!1){const r=n?l:l.filter((n=>n.type===t));return e?r.filter((t=>!0===t.holiday)):r},getAllHolidays(t,n=!1){return this.getAllEvents(t,n).filter((t=>!0===t.holiday))},getEventTypes(){const t=new Set;return l.forEach((n=>t.add(n.type))),Array.from(t)},getSourceMetadata(){return h.Source||{}},async initialize(){await r()},async refreshEvents(){const t=new Date,n=o.gregorianToJalali(t.getFullYear(),t.getMonth()+1,t.getDate());return p!==n[0]&&await r(),[...l]}},v=["Iran","AncientIran","International"];class b extends HTMLElement{toPersianNum(t){const n=["۰","۱","۲","۳","۴","۵","۶","۷","۸","۹"];return(""+t).replace(/\d/g,(t=>n[parseInt(t)]))}static get observedAttributes(){return["placeholder","rtl","format","show-holidays","holiday-types","today-button-text","today-button-class","tomorrow-button-text","tomorrow-button-class","min-date","max-date","disabled-dates","range-mode","show-month-selector","show-year-selector","show-prev-button","show-next-button","show-today-button","show-tomorrow-button"]}constructor(t={}){super(),this.jalaliYear=0,this.jalaliMonth=0,this.jalaliDay=0,this.selectedDate=null,this.isRangeMode=!1,this.rangeStart=null,this.rangeEnd=null,this.isSelectingRange=!1,this.showHolidays=!0,this.holidayTypes=[...v],this.includeAllTypes=!1,this.isTransitioning=!1,this.t=()=>{},this.persianMonths=["فروردین","اردیبهشت","خرداد","تیر","مرداد","شهریور","مهر","آبان","آذر","دی","بهمن","اسفند"],this.holidayTypeLabels={Iran:"ایران",Afghanistan:"افغانستان",AncientIran:"ایران باستان",International:"بین‌المللی"},this.format="YYYY/MM/DD",this.minDate=null,this.maxDate=null,this.disabledDatesFn=null,this.handleInputClick=t=>{t.stopPropagation(),this.toggleCalendar()},this.handleDocumentClick=t=>{this.calendar&&this.calendar.classList.contains("visible")&&(t.composedPath().includes(this)||(this.closeAllDropdowns(),this.toggleCalendar()))},this.options=t;const n=this.attachShadow({mode:"open"});this.render(n),t.holidayTypes&&this.setHolidayTypes(t.holidayTypes)}async connectedCallback(){try{if(!this.shadowRoot)return;this.initializeDomReferences(),this.initializeCurrentDate(),await g.initialize(),this.initializeUIComponents(),this.addEventListeners(),this.initTouchGestures(),this.renderCalendar()}catch(t){}}disconnectedCallback(){this.t&&document.removeEventListener("click",this.t),b.openCalendarInstance===this&&(b.openCalendarInstance=null),[this.input,this.calendar,this.daysContainer,this.dayNamesContainer].forEach((t=>{if(t){const n=t.cloneNode(!1);t.parentNode&&t.parentNode.replaceChild(n,t)}}))}attributeChangedCallback(t,n,e){if(n!==e&&this.shadowRoot)switch(t){case"placeholder":this.input&&(this.input.placeholder=e||"");break;case"rtl":this.style.setProperty("--jdp-direction",null!==e&&"false"!==e?"rtl":"ltr");break;case"show-holidays":this.showHolidays=null!==e&&"false"!==e,this.calendar&&this.renderCalendar();break;case"holiday-types":e?this.setHolidayTypes(e):(this.holidayTypes=[...v],this.includeAllTypes=!1),this.calendar&&this.renderCalendar();break;case"format":e&&this.isValidFormat(e)&&(this.format=e,this.selectedDate&&this.formatAndSetValue());break;case"min-date":if(e)try{const[t,n,r]=JSON.parse(e);this.setMinDate(t,n,r)}catch(t){}else this.minDate=null;this.calendar&&this.renderCalendar();break;case"max-date":if(e)try{const[t,n,r]=JSON.parse(e);this.setMaxDate(t,n,r)}catch(t){}else this.maxDate=null;this.calendar&&this.renderCalendar();break;case"disabled-dates":if(e){const t=window[e];"function"==typeof t&&(this.disabledDatesFn=t)}else this.disabledDatesFn=null;this.calendar&&this.renderCalendar();break;case"today-button-text":case"tomorrow-button-text":this.updateButtonText(t,e);break;case"today-button-class":case"tomorrow-button-class":this.updateButtonClass(t,e);break;case"range-mode":this.isRangeMode=null!==e&&"false"!==e,this.calendar&&this.renderCalendar();break;case"show-month-selector":case"show-year-selector":case"show-prev-button":case"show-next-button":case"show-today-button":case"show-tomorrow-button":this.shadowRoot&&(this.render(this.shadowRoot),this.initializeDomReferences(),this.initializeUIComponents(),this.addEventListeners(),this.renderCalendar())}}updateButtonText(t,n){if(!this.shadowRoot)return;const e="today-button-text"===t?"امروز":"فردا",r=this.shadowRoot.getElementById("today-button-text"===t?"today-button":"tomorrow-button");r&&(r.textContent=n||e)}updateButtonClass(t,n){if(!this.shadowRoot)return;const e="today-button-class"===t?"today-button":"tomorrow-button",r=this.shadowRoot.getElementById("today-button-class"===t?"today-button":"tomorrow-button");r&&(r.className="date-nav-button "+e,n&&n.split(" ").forEach((t=>{t.trim()&&r.classList.add(t.trim())})))}initializeDomReferences(){if(this.shadowRoot){if(this.input=this.shadowRoot.getElementById("date-input"),this.calendar=this.shadowRoot.getElementById("calendar"),this.daysContainer=this.shadowRoot.getElementById("days-container"),this.dayNamesContainer=this.shadowRoot.getElementById("day-names"),!(this.input&&this.calendar&&this.daysContainer&&this.dayNamesContainer))throw Error("Failed to initialize required elements");if(this.options.placeholder)this.input.placeholder=this.options.placeholder;else{const t=this.getAttribute("placeholder");t&&(this.input.placeholder=t)}}}initializeCurrentDate(){const t=new Date,n=o.gregorianToJalali(t.getFullYear(),t.getMonth()+1,t.getDate());this.jalaliYear=n[0],this.jalaliMonth=n[1],this.jalaliDay=n[2],this.selectedDate=null}initializeUIComponents(){this.initializeDayNames(),this.setupMonthYearSelectors(),g.refreshEvents()}initializeDayNames(){this.dayNamesContainer&&(this.dayNamesContainer.innerHTML="",["ش","ی","د","س","چ","پ","ج"].forEach((t=>{const n=document.createElement("div");n.classList.add("day-name"),n.textContent=t,this.dayNamesContainer.appendChild(n)})))}setupMonthYearSelectors(){if(!this.shadowRoot)return;const t=this.shadowRoot.getElementById("month-select-trigger"),n=this.shadowRoot.getElementById("year-select-trigger"),e=this.shadowRoot.getElementById("month-select-value"),r=this.shadowRoot.getElementById("year-select-value"),i=this.shadowRoot.getElementById("month-select-content"),a=this.shadowRoot.getElementById("year-select-content");if(!(t&&n&&e&&r&&i&&a))return;i.innerHTML="",a.innerHTML="",this.persianMonths.forEach(((t,n)=>{const r=n+1,a=document.createElement("div");a.classList.add("select-item"),a.textContent=t,a.dataset.value=""+r,r===this.jalaliMonth&&(a.classList.add("selected"),e.textContent=t),a.addEventListener("click",(n=>{n.stopPropagation(),this.handleMonthChange(r,t),this.closeAllDropdowns()})),i.appendChild(a)}));const s=new Date,d=o.gregorianToJalali(s.getFullYear(),s.getMonth()+1,s.getDate())[0],l=d+50;for(let t=d-100;l>=t;t++){const n=document.createElement("div");n.classList.add("select-item"),n.textContent=this.toPersianNum(t),n.dataset.value=""+t,t===this.jalaliYear&&(n.classList.add("selected"),r.textContent=this.toPersianNum(t)),n.addEventListener("click",(n=>{n.stopPropagation(),this.handleYearChange(t),this.closeAllDropdowns()})),a.appendChild(n)}t.addEventListener("click",(t=>{t.stopPropagation(),this.toggleDropdown(i)})),n.addEventListener("click",(t=>{t.stopPropagation(),this.toggleDropdown(a)})),i.addEventListener("click",(t=>{t.stopPropagation()})),a.addEventListener("click",(t=>{t.stopPropagation()}))}addEventListeners(){this.shadowRoot&&this.input&&this.calendar&&(this.input.addEventListener("click",this.handleInputClick),this.setupNavigationButtons(),this.calendar.addEventListener("click",(t=>t.stopPropagation())),this.calendar.addEventListener("click",(t=>{const n=t.target;n.closest(".select-trigger")||n.closest(".select-content")||this.closeAllDropdowns()})),this.t=this.handleDocumentClick.bind(this),document.addEventListener("click",this.t))}setupNavigationButtons(){if(!this.shadowRoot)return;const t=this.shadowRoot.getElementById("prev-month"),n=this.shadowRoot.getElementById("next-month"),e=this.shadowRoot.getElementById("today-button"),r=this.shadowRoot.getElementById("tomorrow-button"),i=(t,n)=>{t&&t.addEventListener("click",(t=>{t.stopPropagation(),this.closeAllDropdowns(),n()}))};i(t,(()=>this.changeMonth(-1))),i(n,(()=>this.changeMonth(1))),i(e,(()=>this.goToToday())),i(r,(()=>this.goToTomorrow()))}setHolidayTypes(t){if("string"==typeof t){if("all"===t.toLowerCase())return this.includeAllTypes=!0,void(this.holidayTypes=[...g.getEventTypes()]);this.holidayTypes=t.split(",").map((t=>t.trim())).filter(Boolean)}else this.holidayTypes=Array.isArray(t)?[...t]:[...v];this.includeAllTypes=!1,this.calendar&&this.renderCalendar()}getHolidayTypes(){return[...this.holidayTypes]}isShowingAllTypes(){return this.includeAllTypes}render(t){const n=this.getAttribute("today-button-text")||"امروز",e=this.getAttribute("today-button-class")||"",r=this.getAttribute("tomorrow-button-text")||"فردا",i=this.getAttribute("tomorrow-button-class")||"",a="false"!==this.getAttribute("show-month-selector"),o="false"!==this.getAttribute("show-year-selector"),s="false"!==this.getAttribute("show-prev-button"),d="false"!==this.getAttribute("show-next-button"),l="false"!==this.getAttribute("show-today-button"),h="false"!==this.getAttribute("show-tomorrow-button"),c='<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"/></svg>';t.innerHTML=`\n      <style>:host {\n  /* Color scheme */\n  --jdp-primary: #0891b2;\n  --jdp-primary-hover: #0e7490;\n  --jdp-primary-foreground: #ffffff;\n  \n  /* Neutral colors */\n  --jdp-background: #ffffff;\n  --jdp-foreground: #1e293b;\n  --jdp-muted: #f1f5f9;\n  --jdp-muted-foreground: #64748b;\n  --jdp-border: #e2e8f0;\n  --jdp-ring: #0284c7;\n  \n  /* Holiday colors */\n  --jdp-holiday-color: #ef4444;\n  --jdp-holiday-bg: #fee2e2;\n  --jdp-holiday-hover-bg: #fecaca;\n  \n  /* Range selection colors */\n  --jdp-range-bg: rgba(8, 145, 178, 0.1);\n  --jdp-range-color: var(--jdp-foreground);\n  --jdp-range-start-bg: var(--jdp-primary);\n  --jdp-range-start-color: var(--jdp-primary-foreground);\n  --jdp-range-end-bg: var(--jdp-primary);\n  --jdp-range-end-color: var(--jdp-primary-foreground);\n  \n  /* Typography */\n  --jdp-font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;\n  --jdp-font-size: 14px;\n  --jdp-line-height: 1.5;\n  --jdp-font-weight: 400;\n  --jdp-font-weight-medium: 500;\n  --jdp-day-name-font-size: 12px;\n  --jdp-day-name-font-weight: 400;\n  --jdp-day-font-size: 13px;\n  --jdp-day-font-weight: 400;\n  --jdp-month-year-font-size: 14px;\n  --jdp-month-year-font-weight: 500;\n  \n  /* Spacing */\n  --jdp-spacing-xs: 4px;\n  --jdp-spacing-sm: 8px;\n  --jdp-spacing-md: 16px;\n  --jdp-spacing-lg: 24px;\n  \n  /* Input field */\n  --jdp-input-padding-x: 14px;\n  --jdp-input-padding-y: 10px;\n  --jdp-input-border-width: 1px;\n  --jdp-input-border-color: var(--jdp-border);\n  --jdp-input-border-radius: var(--jdp-border-radius);\n  --jdp-input-focus-ring-width: 2px;\n  --jdp-input-focus-ring-color: rgba(2, 132, 199, 0.25);\n  \n  /* Calendar popup */\n  --jdp-calendar-width: 280px;\n  --jdp-calendar-padding: var(--jdp-spacing-md);\n  --jdp-calendar-border-width: 1px;\n  --jdp-calendar-border-color: var(--jdp-border);\n  --jdp-calendar-border-radius: var(--jdp-border-radius);\n  --jdp-calendar-shadow: 0px 10px 38px -10px rgba(22, 23, 24, 0.35), 0px 10px 20px -15px rgba(22, 23, 24, 0.2);\n  --jdp-calendar-z-index: 10;\n  \n  /* Navigation buttons */\n  --jdp-nav-button-size: 30px;\n  --jdp-nav-button-bg: var(--jdp-muted);\n  --jdp-nav-button-bg-hover: var(--jdp-border);\n  --jdp-nav-button-border-radius: var(--jdp-border-radius);\n  --jdp-nav-arrow-size: 8px;\n  --jdp-nav-arrow-thickness: 2px;\n  --jdp-nav-arrow-color: var(--jdp-foreground);\n  \n  /* Day grid */\n  --jdp-day-cell-size: 32px;\n  --jdp-day-cell-margin: 1px;\n  --jdp-day-cell-border-radius: var(--jdp-border-radius);\n  \n  /* States */\n  --jdp-day-hover-bg: var(--jdp-muted);\n  --jdp-day-selected-bg: var(--jdp-primary);\n  --jdp-day-selected-color: var(--jdp-primary-foreground);\n  --jdp-day-today-border-color: var(--jdp-primary);\n  --jdp-day-today-border-width: 1px;\n  --jdp-day-disabled-opacity: 0.4;\n  \n  /* Animations */\n  --jdp-transition-duration: 0.2s;\n  --jdp-fade-from-y: -4px;\n  --jdp-fade-from-y-reverse: 4px;\n  --jdp-month-transition-duration: 0.3s;\n  \n  /* Layout */\n  --jdp-border-radius: 0.5rem;\n  --jdp-direction: rtl;\n  --jdp-header-gap: var(--jdp-spacing-xs);\n\n  /* Select boxes - default values that can be overridden */\n  --jdp-select-container-gap: 8px;\n  --jdp-select-trigger-height: var(--jdp-nav-button-size);\n  --jdp-select-trigger-bg: var(--jdp-muted);\n  --jdp-select-trigger-max-width: 110px;\n  --jdp-select-month-trigger-max-width: var(--jdp-select-trigger-max-width);\n  --jdp-select-year-trigger-max-width: var(--jdp-select-trigger-max-width);\n  --jdp-select-dropdown-width: auto;\n  --jdp-select-text-overflow: ellipsis;\n  \n  /* Scrollbar styling - thin and subtle */\n  --jdp-scrollbar-width: 4px;\n  --jdp-scrollbar-track: transparent;\n  --jdp-scrollbar-thumb: rgba(0, 0, 0, 0.15);\n  --jdp-scrollbar-thumb-hover: rgba(0, 0, 0, 0.25);\n  --jdp-scrollbar-border-radius: 4px;\n}\n\n* {\n  box-sizing: border-box;\n  direction: var(--jdp-direction);\n}\n\n.picker-container {\n  position: relative;\n  display: inline-block;\n  width: 100%;\n  font-family: var(--jdp-font-family);\n  font-size: var(--jdp-font-size);\n  line-height: var(--jdp-line-height);\n  font-weight: var(--jdp-font-weight);\n}\n\ninput {\n  width: 100%;\n  padding: var(--jdp-input-padding-y) var(--jdp-input-padding-x);\n  border-radius: var(--jdp-input-border-radius);\n  border: var(--jdp-input-border-width) solid var(--jdp-input-border-color);\n  font-size: var(--jdp-font-size);\n  line-height: var(--jdp-line-height);\n  font-family: inherit;\n  background-color: var(--jdp-background);\n  color: var(--jdp-foreground);\n  cursor: pointer;\n  outline: none;\n  transition: all var(--jdp-transition-duration) ease;\n  text-align: right;\n}\n\ninput:focus {\n  border-color: var(--jdp-ring);\n  box-shadow: 0 0 0 var(--jdp-input-focus-ring-width) var(--jdp-input-focus-ring-color);\n}\n\n.calendar {\n  display: none;\n  position: absolute;\n  right: 0;\n  width: var(--jdp-calendar-width);\n  background: var(--jdp-background);\n  border: var(--jdp-calendar-border-width) solid var(--jdp-calendar-border-color);\n  border-radius: var(--jdp-calendar-border-radius);\n  box-shadow: var(--jdp-calendar-shadow);\n  padding: var(--jdp-calendar-padding);\n  text-align: center;\n  z-index: var(--jdp-calendar-z-index);\n  touch-action: manipulation;\n  -webkit-user-select: none;\n  user-select: none;\n  transform: translateZ(0);\n  will-change: transform;\n  backface-visibility: hidden;\n  contain: layout style;\n}\n\n.calendar.position-bottom {\n  top: calc(100% + 5px);\n  animation: fadeInFromTop var(--jdp-transition-duration) ease;\n}\n\n.calendar.position-top {\n  bottom: calc(100% + 5px);\n  animation: fadeInFromBottom var(--jdp-transition-duration) ease;\n}\n\n.calendar.visible {\n  display: block;\n}\n\n@keyframes fadeInFromTop {\n  from { opacity: 0; transform: translateY(var(--jdp-fade-from-y)); }\n  to { opacity: 1; transform: translateY(0); }\n}\n\n@keyframes fadeInFromBottom {\n  from { opacity: 0; transform: translateY(var(--jdp-fade-from-y-reverse)); }\n  to { opacity: 1; transform: translateY(0); }\n}\n\n.header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: var(--jdp-spacing-md);\n  gap: var(--jdp-header-gap, var(--jdp-spacing-xs));\n}\n\n.month-year {\n  font-weight: var(--jdp-month-year-font-weight);\n  font-size: var(--jdp-month-year-font-size);\n  color: var(--jdp-foreground);\n  transition: opacity var(--jdp-transition-duration) ease;\n}\n\n.month-year.fade {\n  opacity: 0;\n}\n\n.days-wrapper {\n  position: relative;\n  touch-action: pan-y;\n  overflow: visible;\n  z-index: 1;\n  contain: layout;\n  isolation: isolate;\n}\n\n.days {\n  display: grid;\n  grid-template-columns: repeat(7, 1fr);\n  transition: transform var(--jdp-month-transition-duration) ease, opacity var(--jdp-month-transition-duration) ease;\n  will-change: transform, opacity;\n  transform: translateZ(0);\n  backface-visibility: hidden;\n  position: relative;\n  contain: layout;\n}\n\n.days.slide-left {\n  animation: slideInLeft var(--jdp-month-transition-duration) ease;\n}\n\n.days.slide-right {\n  animation: slideInRight var(--jdp-month-transition-duration) ease;\n}\n\n@keyframes slideInLeft {\n  from { \n    opacity: 0; \n    transform: translateX(-10%) translateZ(0);\n    pointer-events: none;\n  }\n  to { \n    opacity: 1; \n    transform: translateX(0) translateZ(0);\n    pointer-events: auto;\n  }\n}\n\n@keyframes slideInRight {\n  from { \n    opacity: 0; \n    transform: translateX(10%) translateZ(0); \n    pointer-events: none;\n  }\n  to { \n    opacity: 1; \n    transform: translateX(0) translateZ(0);\n    pointer-events: auto;\n  }\n}\n\n.day {\n  position: relative;\n  z-index: 1;\n  touch-action: manipulation;\n  isolation: isolate;\n}\n\n.day:hover {\n  z-index: 2;\n}\n\n.nav-button {\n  background: var(--jdp-nav-button-bg);\n  border: none;\n  border-radius: var(--jdp-nav-button-border-radius);\n  width: var(--jdp-nav-button-size);\n  height: var(--jdp-nav-button-size);\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all var(--jdp-transition-duration) ease;\n  position: relative;\n  touch-action: manipulation;\n  will-change: transform, background-color;\n}\n\n.nav-button:hover {\n  background: var(--jdp-nav-button-bg-hover);\n}\n\n.nav-button:active {\n  transform: translateY(1px);\n}\n\n.nav-button::before {\n  content: '';\n  display: block;\n  width: var(--jdp-nav-arrow-size);\n  height: var(--jdp-nav-arrow-size);\n  border-top: var(--jdp-nav-arrow-thickness) solid var(--jdp-nav-arrow-color);\n  border-right: var(--jdp-nav-arrow-thickness) solid var(--jdp-nav-arrow-color);\n  position: absolute;\n}\n\n.nav-button.prev::before {\n  transform: rotate(45deg);\n  right: 11px;\n  left: auto;\n}\n\n.nav-button.next::before {\n  transform: rotate(225deg);\n  left: 11px;\n  right: auto;\n}\n\n.day-names {\n  display: grid;\n  grid-template-columns: repeat(7, 1fr);\n  margin-bottom: var(--jdp-spacing-sm);\n}\n\n.day-name {\n  font-size: var(--jdp-day-name-font-size);\n  font-weight: var(--jdp-day-name-font-weight);\n  color: var(--jdp-muted-foreground);\n  padding: var(--jdp-spacing-xs) 0;\n  text-align: center;\n}\n\n.day {\n  aspect-ratio: 1/1;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-radius: var(--jdp-day-cell-border-radius);\n  font-size: var(--jdp-day-font-size);\n  font-weight: var(--jdp-day-font-weight);\n  cursor: pointer;\n  transition: var(--jdp-transition-duration) ease;\n  margin: var(--jdp-day-cell-margin);\n  position: relative;\n  touch-action: manipulation;\n  -webkit-tap-highlight-color: transparent;\n  -webkit-user-select: none;\n  user-select: none;\n}\n\n.day:hover:not(.empty):not(.disabled) {\n  background: var(--jdp-day-hover-bg);\n}\n\n.day.selected {\n  background: var(--jdp-day-selected-bg);\n  color: var(--jdp-day-selected-color);\n}\n\n.day.today:not(.selected) {\n  border: var(--jdp-day-today-border-width) solid var(--jdp-day-today-border-color);\n}\n\n.day.empty {\n  cursor: default;\n}\n\n.day.disabled {\n  opacity: var(--jdp-day-disabled-opacity);\n  cursor: not-allowed;\n}\n\n/* Holiday styles */\n.day.holiday:not(.selected) {\n  color: var(--jdp-holiday-color);\n  background-color: var(--jdp-holiday-bg);\n  font-weight: var(--jdp-font-weight-medium);\n}\n\n.day.holiday:hover:not(.selected):not(.disabled) {\n  background-color: var(--jdp-holiday-hover-bg);\n}\n\n/* Special styling for holidays within a range */\n.day.holiday.in-range {\n  background-color: var(--jdp-range-bg);\n  color: var(--jdp-range-color);\n}\n\n.day.holiday.range-start,\n.day.holiday.range-end {\n  background-color: var(--jdp-range-start-bg);\n  color: var(--jdp-range-start-color);\n}\n\n.day.friday {\n  color: var(--jdp-holiday-color);\n}\n\n.event-tooltip {\n  position: absolute;\n  background: var(--jdp-background);\n  border: 1px solid var(--jdp-border);\n  border-radius: var(--jdp-border-radius);\n  padding: var(--jdp-spacing-sm);\n  width: 200px;\n  box-shadow: var(--jdp-calendar-shadow);\n  text-align: right;\n  font-size: 12px;\n  opacity: 0;\n  visibility: hidden;\n  transition: opacity var(--jdp-transition-duration) ease, visibility var(--jdp-transition-duration) ease;\n  pointer-events: none;\n  bottom: 120%;\n  right: 0;\n  transform: translateY(-5px);\n  z-index: 9999;\n}\n\n.event-tooltip.tooltip-visible {\n  opacity: 1;\n  visibility: visible;\n  pointer-events: auto;\n  background: var(--jdp-background);\n}\n\n/* Mobile-specific tooltip positioning */\n@media (max-width: 768px) {\n  .event-tooltip {\n    position: fixed;\n    left: 50%;\n    top: 50%;\n    transform: translate(-50%, -50%);\n    width: 90%;\n    max-width: 300px;\n    max-height: 80vh;\n    overflow-y: auto;\n    bottom: auto;\n    right: auto;\n    background: var(--jdp-background);\n    z-index: 9999;\n  }\n\n  .event-tooltip::before {\n    content: '';\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    z-index: -1;\n  }\n}\n\n.event-item {\n  margin-bottom: 4px;\n  padding-bottom: 4px;\n  border-bottom: 1px solid var(--jdp-border);\n  color: var(--jdp-foreground);\n  background: var(--jdp-background);\n}\n\n.event-item:last-child {\n  margin-bottom: 0;\n  padding-bottom: 0;\n  border-bottom: none;\n}\n\n.event-item.holiday {\n  color: var(--jdp-holiday-color);\n}\n\n.event-type-label {\n  display: inline-block;\n  font-size: 10px;\n  padding: 1px 4px;\n  border-radius: 3px;\n  margin-right: 4px;\n  background-color: var(--jdp-muted);\n  color: var(--jdp-muted-foreground);\n}\n\n/* Today button styling */\n.footer {\n  margin-top: var(--jdp-spacing-md);\n  display: flex;\n  justify-content: space-between;\n}\n\n.date-nav-button {\n  background: var(--jdp-muted);\n  border: none;\n  border-radius: var(--jdp-border-radius);\n  padding: var(--jdp-spacing-xs) var(--jdp-spacing-md);\n  font-family: inherit;\n  font-size: var(--jdp-font-size);\n  color: var(--jdp-foreground);\n  cursor: pointer;\n  transition: all var(--jdp-transition-duration) ease;\n  touch-action: manipulation;\n  -webkit-tap-highlight-color: transparent;\n}\n\n.date-nav-button:hover {\n  background: var(--jdp-nav-button-bg-hover);\n}\n\n.date-nav-button:active {\n  transform: translateY(1px);\n}\n\n/* Month/Year selectors - scoped to the component */\n:host .selectors-container {\n  display: flex;\n  gap: var(--jdp-select-container-gap, 8px);\n  position: relative;\n  align-items: var(--jdp-select-container-align, center);\n  justify-content: var(--jdp-select-container-justify, space-between);\n  width: 100%;\n  max-width: calc(100% - var(--jdp-nav-button-size) * 2 - var(--jdp-spacing-sm));\n  margin: 0 var(--jdp-spacing-xs);\n}\n\n:host .custom-select {\n  position: relative;\n  user-select: none;\n  width: 100%;\n  margin: 0 var(--jdp-spacing-xs, 2px);\n}\n\n:host .month-select {\n  margin-left: var(--jdp-month-select-margin-left, 0);\n  margin-right: var(--jdp-month-select-margin-right, 0);\n}\n\n:host .year-select {\n  margin-left: var(--jdp-year-select-margin-left, 0);\n  margin-right: var(--jdp-year-select-margin-right, 0);\n}\n\n:host .select-trigger {\n  display: flex;\n  align-items: center;\n  justify-content: var(--jdp-select-trigger-justify, center);\n  gap: 0 4px;\n  width: 100%;\n  height: var(--jdp-select-trigger-height, var(--jdp-nav-button-size));\n  min-height: var(--jdp-nav-button-size);\n  background-color: var(--jdp-select-trigger-bg, var(--jdp-muted));\n  border: var(--jdp-select-trigger-border-width, 1px) solid var(--jdp-select-trigger-border-color, var(--jdp-border));\n  border-radius: var(--jdp-select-trigger-border-radius, var(--jdp-border-radius));\n  color: var(--jdp-select-trigger-color, var(--jdp-foreground));\n  font-family: inherit;\n  font-size: var(--jdp-select-trigger-font-size, var(--jdp-font-size));\n  line-height: 1;\n  padding: 0 var(--jdp-select-trigger-padding-x, 0);\n  cursor: pointer;\n  transition: all var(--jdp-transition-duration) ease;\n  text-align: var(--jdp-select-trigger-text-align, center);\n  min-width: var(--jdp-select-trigger-min-width, initial);\n  outline: none;\n  font-weight: var(--jdp-select-trigger-font-weight, 500);\n  box-sizing: border-box;\n  max-width: var(--jdp-select-trigger-max-width, 110px);\n}\n\n:host .month-select .select-trigger {\n  max-width: var(--jdp-select-month-trigger-max-width, var(--jdp-select-trigger-max-width));\n}\n\n:host .year-select .select-trigger {\n  max-width: var(--jdp-select-year-trigger-max-width, var(--jdp-select-trigger-max-width));\n}\n\n:host .select-trigger span:first-child {\n  white-space: nowrap;\n  overflow: var(--jdp-select-trigger-overflow, visible);\n  text-overflow: var(--jdp-select-text-overflow, ellipsis);\n  max-width: calc(100% - 24px);\n  display: inline-block;\n  text-align: center;\n  flex: 1;\n}\n\n:host .select-trigger:hover {\n  background-color: var(--jdp-select-trigger-bg-hover, rgba(0, 0, 0, 0.05));\n  border-color: var(--jdp-select-trigger-border-hover, var(--jdp-border));\n}\n\n:host .select-trigger:focus-visible {\n  outline: 2px solid var(--jdp-select-trigger-focus-ring-color, var(--jdp-ring));\n  outline-offset: var(--jdp-select-trigger-focus-ring-offset, 2px);\n}\n\n:host .select-icon {\n  margin-left: var(--jdp-select-icon-margin, var(--jdp-spacing-xs));\n  display: var(--jdp-select-icon-display, none);\n  justify-content: center;\n  align-items: center;\n  transition: transform 0.2s ease;\n  width: var(--jdp-select-icon-size, 12px);\n  height: var(--jdp-select-icon-size, 12px);\n  opacity: var(--jdp-select-icon-opacity, 0.7);\n  flex-shrink: 0;\n}\n\n:host .select-icon svg {\n  width: var(--jdp-select-icon-size, 12px);\n  height: var(--jdp-select-icon-size, 12px);\n}\n\n:host .select-content.open .select-icon {\n  transform: rotate(180deg);\n}\n\n:host .select-content {\n  position: var(--jdp-select-content-position, absolute);\n  top: calc(100% + var(--jdp-select-content-top-offset, 5px));\n  left: 0;\n  width: var(--jdp-select-dropdown-width, 100%);\n  min-width: 100%;\n  background-color: var(--jdp-select-content-bg, var(--jdp-background));\n  border: var(--jdp-select-content-border-width, 1px) solid var(--jdp-select-content-border-color, var(--jdp-border));\n  border-radius: var(--jdp-select-content-border-radius, var(--jdp-border-radius));\n  box-shadow: var(--jdp-select-content-shadow, 0 4px 8px rgba(0,0,0,0.1));\n  z-index: var(--jdp-select-content-z-index, 20);\n  overflow-y: auto;\n  max-height: var(--jdp-select-content-max-height, 200px);\n  display: none;\n  padding: var(--jdp-select-content-padding-y, 0.25rem) var(--jdp-select-content-padding-x, 0);\n  scroll-behavior: smooth;\n  \n  /* Custom scrollbar styling */\n  scrollbar-width: var(--jdp-scrollbar-width-size, none);\n  scrollbar-color: var(--jdp-scrollbar-thumb, rgba(0, 0, 0, 0.15)) var(--jdp-scrollbar-track, transparent);\n}\n\n/* Webkit-based browsers (Chrome, Safari, Edge) */\n:host .select-content::-webkit-scrollbar {\n  width: var(--jdp-scrollbar-width, 4px);\n}\n\n:host .select-content::-webkit-scrollbar-track {\n  background: var(--jdp-scrollbar-track, transparent);\n  border-radius: var(--jdp-scrollbar-border-radius, 4px);\n}\n\n:host .select-content::-webkit-scrollbar-thumb {\n  background-color: var(--jdp-scrollbar-thumb, rgba(0, 0, 0, 0.15));\n  border-radius: var(--jdp-scrollbar-border-radius, 4px);\n}\n\n:host .select-content::-webkit-scrollbar-thumb:hover {\n  background-color: var(--jdp-scrollbar-thumb-hover, rgba(0, 0, 0, 0.25));\n}\n\n:host .select-content.open {\n  display: block;\n  animation: fadeInSelect var(--jdp-select-content-animation-duration, var(--jdp-transition-duration)) ease;\n}\n\n:host .month-select-content {\n  width: var(--jdp-select-month-width, var(--jdp-select-dropdown-width, auto));\n  min-width: 100%;\n}\n\n:host .year-select-content {\n  width: var(--jdp-select-year-width, var(--jdp-select-dropdown-width, auto));\n  min-width: 100%;\n}\n\n:host .select-item {\n  padding: var(--jdp-select-item-padding-y, 0.5rem) var(--jdp-select-item-padding-x, 0.75rem);\n  cursor: pointer;\n  transition: background-color var(--jdp-transition-duration) ease;\n  border-radius: var(--jdp-select-item-border-radius, var(--jdp-select-trigger-border-radius, var(--jdp-border-radius)));\n  margin: var(--jdp-select-item-margin, 0 0.25rem);\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  max-width: var(--jdp-select-item-max-width, 100%);\n  box-sizing: border-box;\n  text-align: var(--jdp-select-item-text-align, center);\n}\n\n:host .select-item:hover {\n  background-color: var(--jdp-select-item-hover-bg, var(--jdp-day-hover-bg));\n}\n\n:host .select-item.selected {\n  background-color: var(--jdp-select-item-selected-bg, var(--jdp-primary));\n  color: var(--jdp-select-item-selected-color, var(--jdp-primary-foreground));\n  font-weight: var(--jdp-select-item-selected-font-weight, var(--jdp-font-weight-medium));\n  border-radius: var(--jdp-select-item-selected-border-radius, var(--jdp-select-trigger-border-radius, var(--jdp-border-radius)));\n}\n\n@keyframes fadeInSelect {\n  from { opacity: 0; transform: translateY(-5px); }\n  to { opacity: 1; transform: translateY(0); }\n}\n\n/* RTL specific styles */\n:host([rtl="true"]) .select-icon,\n:host([dir="rtl"]) .select-icon {\n  margin-left: 0;\n  margin-right: var(--jdp-select-icon-margin, var(--jdp-spacing-xs));\n}\n\n:host([rtl="true"]) .select-item,\n:host([dir="rtl"]) .select-item {\n  text-align: var(--jdp-select-item-text-align, right);\n}\n\n/* Dark mode support using CSS media query for scrollbar */\n@media (prefers-color-scheme: dark) {\n  :host {\n    --jdp-scrollbar-thumb: rgba(124, 124, 124, 0.15);\n    --jdp-scrollbar-thumb-hover: rgba(41, 41, 41, 0.25);\n  }\n}\n\n/* Allow manual dark mode toggle via class-based approach */\n:host(.dark-theme) {\n    --jdp-scrollbar-thumb: rgba(124, 124, 124, 0.15);\n    --jdp-scrollbar-thumb-hover: rgba(41, 41, 41, 0.25);\n}\n\n/* Range selection styles */\n.day.in-range {\n  background-color: var(--jdp-range-bg);\n  color: var(--jdp-range-color);\n  position: relative;\n  z-index: 1;\n}\n\n.day.range-start,\n.day.range-end {\n  background-color: var(--jdp-range-start-bg);\n  color: var(--jdp-range-start-color);\n  position: relative;\n  z-index: 2;\n}\n\n.day.range-start {\n  border-radius: var(--jdp-border-radius) 0 0 var(--jdp-border-radius);\n}\n\n.day.range-end {\n  border-radius: 0 var(--jdp-border-radius) var(--jdp-border-radius) 0;\n}\n\n/* RTL specific range styles */\n:host([rtl="true"]) .day.range-start,\n:host([dir="rtl"]) .day.range-start {\n  border-radius: 0 var(--jdp-border-radius) var(--jdp-border-radius) 0;\n}\n\n:host([rtl="true"]) .day.range-end,\n:host([dir="rtl"]) .day.range-end {\n  border-radius: var(--jdp-border-radius) 0 0 var(--jdp-border-radius);\n}\n\n/* Special handling for single day range */\n.day.range-start.range-end {\n  border-radius: var(--jdp-border-radius);\n}\n\n/* Ensure range styles take precedence over other styles */\n.day.in-range:not(.range-start):not(.range-end) {\n  background-color: var(--jdp-range-bg);\n  color: var(--jdp-range-color);\n}\n\n/* Handle disabled dates in range */\n.day.disabled.in-range {\n  opacity: 0.4;\n  background-color: var(--jdp-range-bg);\n  color: var(--jdp-range-color);\n}\n\n/* Handle holidays in range */\n.day.holiday.in-range:not(.range-start):not(.range-end) {\n  background-color: var(--jdp-range-bg);\n  color: var(--jdp-range-color);\n}\n\n.day.holiday.range-start,\n.day.holiday.range-end {\n  background-color: var(--jdp-range-start-bg);\n  color: var(--jdp-range-start-color);\n}\n</style>\n      <div class="picker-container">\n        <input type="text" id="date-input" readonly placeholder="انتخاب تاریخ">\n        <div class="calendar" id="calendar">\n          <div class="header">\n            ${s?'<button id="prev-month" type="button" class="nav-button prev"></button>':""}\n            <div class="selectors-container">\n              ${a?`\n              <div class="custom-select month-select" id="month-select-container">\n                <button type="button" class="select-trigger" id="month-select-trigger">\n                  <span id="month-select-value"></span>\n                  <span class="select-icon">${c}</span>\n                </button>\n                <div class="select-content month-select-content" id="month-select-content"></div>\n              </div>\n              `:""}\n              ${o?`\n              <div class="custom-select year-select" id="year-select-container">\n                <button type="button" class="select-trigger" id="year-select-trigger">\n                  <span id="year-select-value"></span>\n                  <span class="select-icon">${c}</span>\n                </button>\n                <div class="select-content year-select-content" id="year-select-content"></div>\n              </div>\n              `:""}\n            </div>\n            ${d?'<button id="next-month" type="button" class="nav-button next"></button>':""}\n          </div>\n          <div class="day-names" id="day-names"></div>\n          <div class="days-wrapper">\n            <div class="days" id="days-container"></div>\n          </div>\n          <div class="footer">\n            ${l?`<button id="today-button" type="button" class="date-nav-button today-button ${e}">${n}</button>`:""}\n            ${h?`<button id="tomorrow-button" type="button" class="date-nav-button tomorrow-button ${i}">${r}</button>`:""}\n          </div>\n        </div>\n      </div>\n    `}toggleCalendar(){this.closeAllDropdowns(),this.calendar.classList.contains("visible")?(this.calendar.classList.remove("visible","position-bottom","position-top"),b.openCalendarInstance===this&&(b.openCalendarInstance=null)):(b.openCalendarInstance&&b.openCalendarInstance!==this&&b.openCalendarInstance.toggleCalendar(),this.positionCalendar(),this.calendar.classList.add("visible"),b.openCalendarInstance=this)}positionCalendar(){if(!this.input||!this.calendar)return;this.calendar.classList.remove("position-bottom","position-top");const t=this.input.getBoundingClientRect(),n=window.innerHeight;this.calendar.classList.add("position-bottom");const e=this.calendar.style.visibility,r=this.calendar.style.display;this.calendar.style.visibility="hidden",this.calendar.style.display="block";const i=this.calendar.offsetHeight,a=n-t.bottom;if(i>a){const n=t.top;a>=n&&i>n||(this.calendar.classList.remove("position-bottom"),this.calendar.classList.add("position-top"))}this.calendar.style.visibility=e,this.calendar.style.display=r}changeMonth(t){if(this.isTransitioning)return;this.isTransitioning=!0;const n=this.daysContainer,e=t>0?"slide-left":"slide-right";n.classList.add(e),this.jalaliMonth=+this.jalaliMonth+t,1>this.jalaliMonth?(this.jalaliMonth=12,this.jalaliYear--):this.jalaliMonth>12&&(this.jalaliMonth=1,this.jalaliYear++),requestAnimationFrame((()=>{setTimeout((()=>{this.updateMonthYearSelectors(),n.innerHTML="",this.renderCalendarContent(),requestAnimationFrame((()=>{n.classList.remove(e),setTimeout((()=>{this.isTransitioning=!1}),50)}))}),200)}))}updateMonthYearSelectors(){if(!this.shadowRoot)return;const t=this.shadowRoot.getElementById("month-select-value"),n=this.shadowRoot.getElementById("year-select-value");t&&(t.textContent=this.persianMonths[this.jalaliMonth-1]),n&&(n.textContent=this.toPersianNum(this.jalaliYear)),this.shadowRoot.querySelectorAll(".month-select-content .select-item").forEach((t=>{t.getAttribute("data-value")===""+this.jalaliMonth?t.classList.add("selected"):t.classList.remove("selected")})),this.shadowRoot.querySelectorAll(".year-select-content .select-item").forEach((t=>{t.getAttribute("data-value")===""+this.jalaliYear?t.classList.add("selected"):t.classList.remove("selected")}))}renderCalendar(){this.shadowRoot&&this.daysContainer&&(this.updateMonthYearSelectors(),this.daysContainer.innerHTML="",this.renderCalendarContent())}renderCalendarContent(){if(!this.daysContainer)return;const t=o.getDayOfWeek(this.jalaliYear,this.jalaliMonth,1),n=o.getDaysInMonth(this.jalaliYear,this.jalaliMonth),e=new Date,r=o.gregorianToJalali(e.getFullYear(),e.getMonth()+1,e.getDate()),i=(t+1)%7;this.daysContainer.innerHTML="";for(let t=0;i>t;t++){const t=document.createElement("div");t.classList.add("day","empty"),this.daysContainer.appendChild(t)}for(let t=1;n>=t;t++){const n=document.createElement("div");n.classList.add("day"),n.textContent=this.toPersianNum(t);const e=this.isDateInRange(this.jalaliYear,this.jalaliMonth,t),i=this.isDateDisabled(this.jalaliYear,this.jalaliMonth,t);if(!e||i?(n.classList.add("disabled"),n.style.opacity="0.4",n.style.cursor="not-allowed"):(this.setupDayTooltips(n),this.setupDayClickHandler(n,t)),this.jalaliYear===r[0]&&this.jalaliMonth===r[1]&&t===r[2]&&n.classList.add("today"),this.isRangeMode){const e=[this.jalaliYear,this.jalaliMonth,t];if(n.classList.remove("in-range","range-start","range-end"),this.rangeStart&&this.rangeEnd){const t=this.compareDates(e,this.rangeStart)>=0&&0>=this.compareDates(e,this.rangeEnd);0===this.compareDates(e,this.rangeStart)?(n.classList.add("range-start"),0===this.compareDates(e,this.rangeEnd)&&n.classList.add("range-end")):0===this.compareDates(e,this.rangeEnd)?n.classList.add("range-end"):t&&n.classList.add("in-range")}else this.rangeStart&&!this.rangeEnd&&0===this.compareDates(e,this.rangeStart)&&n.classList.add("range-start")}else this.selectedDate&&this.jalaliYear===this.selectedDate[0]&&this.jalaliMonth===this.selectedDate[1]&&t===this.selectedDate[2]&&n.classList.add("selected");this.showHolidays&&this.addHolidayInfo(n,t),this.daysContainer.appendChild(n)}}compareDates(t,n){return t[0]!==n[0]?t[0]-n[0]:t[1]!==n[1]?t[1]-n[1]:t[2]-n[2]}setupDayTooltips(t){t.addEventListener("mouseenter",(()=>{const n=t.querySelector(".event-tooltip");n&&n.classList.add("tooltip-visible")})),t.addEventListener("mouseleave",(()=>{const n=t.querySelector(".event-tooltip");n&&n.classList.remove("tooltip-visible")}))}setupDayClickHandler(t,n){let e=0;t.addEventListener("click",(r=>{r.preventDefault(),r.stopPropagation();const i=(new Date).getTime(),a=i-e;if("ontouchstart"in window||navigator.maxTouchPoints>0)if(500>a&&a>0){const n=t.querySelector(".event-tooltip");if(n){const t=this.shadowRoot?.querySelectorAll(".event-tooltip.tooltip-visible");t?.forEach((t=>t.classList.remove("tooltip-visible"))),n.classList.add("tooltip-visible")}}else this.handleRangeSelection(n);else this.handleRangeSelection(n);e=i}))}addHolidayInfo(t,n){let e=!1;if(5===o.getDayOfWeek(this.jalaliYear,this.jalaliMonth,n)&&(t.classList.add("friday"),e=!0),g.isHoliday(this.jalaliMonth,n,this.holidayTypes,this.includeAllTypes)){t.classList.add("holiday"),e=!0;const r=g.getEvents(this.jalaliMonth,n,this.holidayTypes,this.includeAllTypes);if(r.length>0){const n=this.createEventTooltip(r);t.appendChild(n)}}return e}createEventTooltip(t){const n=document.createElement("div");return n.classList.add("event-tooltip"),t.forEach((t=>{const e=document.createElement("div");e.classList.add("event-item"),t.holiday&&e.classList.add("holiday");const r=document.createElement("span");r.classList.add("event-type-label"),r.textContent=this.holidayTypeLabels[t.type]||t.type,e.appendChild(r);const i=document.createElement("span");i.textContent=t.title,e.appendChild(i),n.appendChild(e)})),n}navigateToDate(t){const n=o.gregorianToJalali(t.getFullYear(),t.getMonth()+1,t.getDate()),e=this.jalaliYear;this.jalaliYear=n[0],this.jalaliMonth=n[1],e!==this.jalaliYear&&g.refreshEvents(),this.renderCalendar(),this.selectDate(n[2])}goToToday(){this.navigateToDate(new Date)}goToTomorrow(){const t=new Date;t.setDate(t.getDate()+1),this.navigateToDate(t)}selectDate(t){this.jalaliDay=t,this.selectedDate=[this.jalaliYear,this.jalaliMonth,this.jalaliDay],this.formatAndSetValue();const n=g.getEvents(this.jalaliMonth,t,this.holidayTypes,this.includeAllTypes),e=this.formatDate(this.selectedDate,this.format);this.dispatchEvent(new CustomEvent("change",{detail:{jalali:this.selectedDate,gregorian:o.jalaliToGregorian(this.jalaliYear,this.jalaliMonth,this.jalaliDay),isHoliday:g.isHoliday(this.jalaliMonth,t,this.holidayTypes,this.includeAllTypes),events:n,formattedDate:e},bubbles:!0})),this.closeAllDropdowns(),this.toggleCalendar(),this.renderCalendar()}formatAndSetValue(){if(this.isRangeMode){if(!this.rangeStart||!this.rangeEnd)return void(this.input.value="");const t=t=>{const[n,e,r]=t;return this.formatDate(t,this.format)};this.input.value=`${t(this.rangeStart)} - ${t(this.rangeEnd)}`}else this.input.value=this.selectedDate?this.formatDate(this.selectedDate,this.format):""}formatDate(t,n){if(!t)return"";const[e,r,i]=t,a=this.handleSpecialFormat(n,e,r,i);return null!==a?a:this.handleGeneralFormat(n,e,r,i)}handleSpecialFormat(t,n,e,r){const i={"YYYY/MM/DD":()=>`${this.toPersianNum(n)}/${this.toPersianNum((""+e).padStart(2,"0"))}/${this.toPersianNum((""+r).padStart(2,"0"))}`,"YYYY-MM-DD":()=>`${this.toPersianNum(n)}-${this.toPersianNum((""+e).padStart(2,"0"))}-${this.toPersianNum((""+r).padStart(2,"0"))}`,"YYYY/MM/DDth":()=>`${this.toPersianNum(n)}/${this.toPersianNum((""+e).padStart(2,"0"))}/${this.toPersianNum(r)}ام`};return i[t]?.()||null}handleGeneralFormat(t,n,e,r){const i=t.split(/(\s+)/),a=[];for(let t=0;i.length>t;t++){const o=i[t];if(!o.trim()){a.push(o);continue}let s=this.replaceFormatTokens(o,n,e,r);a.push(s),i.length-1>t&&i[t+1].trim()&&a.push(" ")}return a.join("")}replaceFormatTokens(t,n,e,r){let i=t;return i.includes("MMMM")?i=i.replace("MMMM",this.persianMonths[e-1]):i.includes("MMM")&&(i=i.replace("MMM",this.persianMonths[e-1].substring(0,3))),i=i.replace("YYYY",this.toPersianNum(n)),i=i.replace("MM",this.toPersianNum((""+e).padStart(2,"0"))),i=i.replace("DD",this.toPersianNum((""+r).padStart(2,"0"))),i=i.replace("dddd",this.getWeekdayName(n,e,r)),i.includes("th")&&(i=i.replace("th","ام")),i}isValidFormat(t){const n=t.includes("YYYY"),e=t.includes("MM"),r=t.includes("DD"),i=/[^YMD\/\-\. dth]/g.test(t);return"YYYY/MM"===t||"DD/MM"===t||"DD.MM.YYYY"===t||"YYYY/MM/DDth"===t||[n,e,r].filter(Boolean).length>=2&&!i}getWeekdayName(t,n,e){return["شنبه","یکشنبه","دوشنبه","سه‌شنبه","چهارشنبه","پنج‌شنبه","جمعه"][new Date(t,n-1,e).getDay()]}handleMonthChange(t,n){this.jalaliMonth!==t&&(this.jalaliMonth=t,this.renderCalendar())}handleYearChange(t){if(this.jalaliYear===t)return;const n=this.jalaliYear;this.jalaliYear=t,n!==t&&g.refreshEvents(),this.renderCalendar()}setValue(t,n,e){this.selectedDate=[t,n,e],this.jalaliYear=t,this.jalaliMonth=n,this.jalaliDay=e,this.formatAndSetValue(),this.renderCalendar()}getValue(){return this.selectedDate?[...this.selectedDate]:null}isSelectedDateHoliday(){return!!this.selectedDate&&g.isHoliday(this.selectedDate[1],this.selectedDate[2],this.holidayTypes,this.includeAllTypes)}getSelectedDateEvents(){return this.selectedDate?[...g.getEvents(this.selectedDate[1],this.selectedDate[2],this.holidayTypes,this.includeAllTypes)]:[]}clear(){this.isRangeMode?(this.rangeStart=null,this.rangeEnd=null):this.selectedDate=null,this.input.value="",this.renderCalendar()}initTouchGestures(){if(!this.calendar||!this.shadowRoot)return;let t=0,n=0,e=!1,r=0,i=!1;this.calendar.addEventListener("touchstart",(a=>{this.calendar?.classList.contains("visible")&&(t=a.touches[0].clientX,n=a.touches[0].clientY,e=!1,i=!1,r=Date.now(),a.stopPropagation())}),{passive:!0}),this.calendar.addEventListener("touchmove",(r=>{if(!this.calendar?.classList.contains("visible"))return;const a=r.touches[0].clientX-t,o=r.touches[0].clientY-n;i?r.preventDefault():Math.abs(a)>Math.abs(o)&&Math.abs(a)>20&&(r.preventDefault(),e=!0,i=!0)}),{passive:!1}),this.calendar.addEventListener("touchend",(a=>{if(!this.calendar?.classList.contains("visible"))return;const o=i;if(i=!1,(300>Date.now()-r||e)&&!this.isTransitioning){const e=a.changedTouches[0].clientX-t,r=a.changedTouches[0].clientY-n;if(Math.abs(e)>Math.abs(r)&&Math.abs(e)>20){const t="rtl"===getComputedStyle(this).getPropertyValue("--jdp-direction").trim();t&&0>e||!t&&e>0?(a.preventDefault(),a.stopPropagation(),this.changeMonth(1)):(t&&e>0||!t&&0>e)&&(a.preventDefault(),a.stopPropagation(),this.changeMonth(-1))}}o&&a.preventDefault()}),{passive:!1}),this.calendar.addEventListener("touchcancel",(()=>{i=!1,e=!1}));const a=this.shadowRoot.getElementById("prev-month"),o=this.shadowRoot.getElementById("next-month");a&&a.addEventListener("touchstart",(t=>t.stopPropagation()),{passive:!0}),o&&o.addEventListener("touchstart",(t=>t.stopPropagation()),{passive:!0})}closeAllDropdowns(){this.shadowRoot&&this.shadowRoot.querySelectorAll(".select-content").forEach((t=>{t.classList.remove("open")}))}toggleDropdown(t){if(!t)return;const n=t.classList.contains("open");this.closeAllDropdowns(),n||(t.classList.add("open"),requestAnimationFrame((()=>{const n=t.querySelector(".select-item.selected");n&&(t.scrollTop=Math.max(0,n.offsetTop-t.clientHeight/2+n.clientHeight/2))})))}open(){this.calendar.classList.contains("visible")||this.toggleCalendar()}close(){this.calendar.classList.contains("visible")&&this.toggleCalendar()}setMinDate(t,n,e){this.minDate=[t,n,e],this.calendar&&this.renderCalendar()}setMaxDate(t,n,e){this.maxDate=[t,n,e],this.calendar&&this.renderCalendar()}isDateInRange(t,n,e){if(!this.minDate&&!this.maxDate)return!0;const r=[t,n,e];return!(this.minDate&&this.minDate>r||this.maxDate&&r>this.maxDate)}isDateDisabled(t,n,e){return!!this.disabledDatesFn&&this.disabledDatesFn(t,n,e)}handleRangeSelection(t){if(!this.isRangeMode)return void this.selectDate(t);const n=[this.jalaliYear,this.jalaliMonth,t];this.isSelectingRange?(this.rangeEnd=n,this.isSelectingRange=!1,this.rangeStart&&this.rangeEnd&&this.compareDates(this.rangeStart,this.rangeEnd)>0&&([this.rangeStart,this.rangeEnd]=[this.rangeEnd,this.rangeStart]),this.formatAndSetValue(),this.dispatchEvent(new CustomEvent("change",{detail:{range:{start:this.rangeStart,end:this.rangeEnd},isRange:!0},bubbles:!0})),this.closeAllDropdowns(),this.toggleCalendar()):(this.rangeStart=n,this.rangeEnd=null,this.isSelectingRange=!0),this.renderCalendar()}setRange(t,n){this.isRangeMode&&(t>n&&([t,n]=[n,t]),this.rangeStart=[...t],this.rangeEnd=[...n],this.formatAndSetValue(),this.renderCalendar())}getRange(){return{start:this.rangeStart?[...this.rangeStart]:null,end:this.rangeEnd?[...this.rangeEnd]:null}}}if(b.openCalendarInstance=null,"undefined"!=typeof window&&"undefined"!=typeof customElements&&!customElements.get("persian-datepicker-element"))try{customElements.define("persian-datepicker-element",b)}catch(t){}const m=b;return i.default})(),"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.PersianDatePickerElement=n():t.PersianDatePickerElement=n();